/*! v2.6.0-a70a3a3a, 2017-10-17T10:29:17Z */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(b.dashjs||(b.dashjs={})).Protection=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){"use strict";var e={};e.encode=function(a){for(var b=[],c=0;c<a.length;++c){var d=a.charCodeAt(c);d<128?b.push(d):d<2048?(b.push(192|d>>6),b.push(128|63&d)):d<65536?(b.push(224|d>>12),b.push(128|63&d>>6),b.push(128|63&d)):(b.push(240|d>>18),b.push(128|63&d>>12),b.push(128|63&d>>6),b.push(128|63&d))}return b},e.decode=function(a){for(var b=[],c=0;c<a.length;){var d=a[c++];d<128||(d<224?(d=(31&d)<<6,d|=63&a[c++]):d<240?(d=(15&d)<<12,d|=(63&a[c++])<<6,d|=63&a[c++]):(d=(7&d)<<18,d|=(63&a[c++])<<12,d|=(63&a[c++])<<6,d|=63&a[c++])),b.push(String.fromCharCode(d))}return b.join("")};var f={};!function(b){var c=function(a){for(var c=0,d=[],e=0|a.length/3;0<e--;){var f=(a[c]<<16)+(a[c+1]<<8)+a[c+2];c+=3,d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push(b.charAt(63&f>>6)),d.push(b.charAt(63&f))}if(2==a.length-c){var f=(a[c]<<16)+(a[c+1]<<8);d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push(b.charAt(63&f>>6)),d.push("=")}else if(1==a.length-c){var f=a[c]<<16;d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push("==")}return d.join("")},d=function(){for(var a=[],c=0;c<b.length;++c)a[b.charCodeAt(c)]=c;return a["=".charCodeAt(0)]=0,a}(),g=function(a){for(var b=0,c=[],e=0|a.length/4;0<e--;){var f=(d[a.charCodeAt(b)]<<18)+(d[a.charCodeAt(b+1)]<<12)+(d[a.charCodeAt(b+2)]<<6)+d[a.charCodeAt(b+3)];c.push(255&f>>16),c.push(255&f>>8),c.push(255&f),b+=4}return c&&("="==a.charAt(b-2)?(c.pop(),c.pop()):"="==a.charAt(b-1)&&c.pop()),c},h={};h.encode=function(a){for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b},h.decode=function(b){for(var c=0;c<s.length;++c)a[c]=String.fromCharCode(a[c]);return a.join("")},f.decodeArray=function(a){var b=g(a);return new Uint8Array(b)},f.encodeASCII=function(a){var b=h.encode(a);return c(b)},f.decodeASCII=function(a){var b=g(a);return h.decode(b)},f.encode=function(a){var b=e.encode(a);return c(b)},f.decode=function(a){var b=g(a);return e.decode(b)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),void 0!==d&&(d.decode=f.decode,d.decodeArray=f.decodeArray)},{}],2:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=function(){function a(a,b,c,d){var e=n(d);!e[a]&&b&&(e[a]={instance:b,override:c})}function b(a,b){for(var c in q){var d=q[c];if(d.context===a&&d.name===b)return d.instance}return null}function c(a,b,c){for(var d in q){var e=q[d];if(e.context===a&&e.name===b)return void(q[d].instance=c)}q.push({name:b,context:a,instance:c})}function d(a,b,c){for(var d in c){if(c[d].name===a)return void(c[d].factory=b)}c.push({name:a,factory:b})}function e(a,b){for(var c in b){if(b[c].name===a)return b[c].factory}return null}function f(a,b,c){for(var d in c){if(c[d].name===a)return void(c[d].factory=b)}}function g(a,b){f(a,b,s)}function h(a){return e(a,s)}function i(a){var b=e(a.__dashjs_factory_name,s);return b||(b=function(b){return void 0===b&&(b={}),{create:function(){return m(a.__dashjs_factory_name,a.apply({context:b},arguments),b,arguments)}}},d(a.__dashjs_factory_name,b,s)),b}function j(a,b){f(a,b,r)}function k(a){return e(a,r)}function l(a){var c=e(a.__dashjs_factory_name,r);return c||(c=function(c){var d=void 0;return void 0===c&&(c={}),{getInstance:function(){return d||(d=b(c,a.__dashjs_factory_name)),d||(d=m(a.__dashjs_factory_name,a.apply({context:c},arguments),c,arguments),q.push({name:a.__dashjs_factory_name,context:c,instance:d})),d}}},d(a.__dashjs_factory_name,c,r)),c}function m(a,b,c,d){b.getClassName=function(){return a};var e=n(c),f=e[a];if(f){var g=f.instance;if(!f.override)return g.apply({context:c,factory:o},d);g=g.apply({context:c,factory:o,parent:b},d);for(var h in g)b.hasOwnProperty(h)&&(b[h]=g[h])}return b}function n(a){var b=void 0;return p.forEach(function(c){c===a&&(b=c)}),b||(b=p.push(a)),b}var o=void 0,p=[],q=[],r=[],s=[];return o={extend:a,getSingletonInstance:b,setSingletonInstance:c,getSingletonFactory:l,getSingletonFactoryByName:k,updateSingletonFactory:j,getClassFactory:i,getClassFactoryByName:h,updateClassFactory:g}}();c.default=d,b.exports=c.default},{}],3:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;if(void 0===i)return;return i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return;a=j,b=f,c=g,d=!0,h=j=void 0}},h=a(5),i=d(h),j=function(a){function b(){e(this,b),g(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.BUFFERING_COMPLETED="bufferingCompleted",this.BUFFER_CLEARED="bufferCleared",this.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",this.BYTES_APPENDED="bytesAppended",this.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",this.CURRENT_TRACK_CHANGED="currentTrackChanged",this.DATA_UPDATE_COMPLETED="dataUpdateCompleted",this.DATA_UPDATE_STARTED="dataUpdateStarted",this.INITIALIZATION_LOADED="initializationLoaded",this.INIT_FRAGMENT_LOADED="initFragmentLoaded",this.INIT_REQUESTED="initRequested",this.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",this.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",this.LOADING_COMPLETED="loadingCompleted",this.LOADING_PROGRESS="loadingProgress",this.MANIFEST_UPDATED="manifestUpdated",this.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",this.QUOTA_EXCEEDED="quotaExceeded",this.REPRESENTATION_UPDATED="representationUpdated",this.SEGMENTS_LOADED="segmentsLoaded",this.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",this.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",this.SOURCEBUFFER_APPEND_COMPLETED="sourceBufferAppendCompleted",this.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",this.STREAMS_COMPOSED="streamsComposed",this.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",this.STREAM_COMPLETED="streamCompleted",this.TIMED_TEXT_REQUESTED="timedTextRequested",this.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",this.URL_RESOLUTION_FAILED="urlResolutionFailed",this.VIDEO_CHUNK_RECEIVED="videoChunkReceived",this.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",this.XLINK_ELEMENT_LOADED="xlinkElementLoaded",this.XLINK_READY="xlinkReady"}return f(b,a),b}(i.default);c.default=j,b.exports=c.default},{5:5}],4:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;if(void 0===i)return;return i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return;a=j,b=f,c=g,d=!0,h=j=void 0}},h=a(3),i=d(h),j=function(a){function b(){e(this,b),g(Object.getPrototypeOf(b.prototype),"constructor",this).apply(this,arguments)}return f(b,a),b}(i.default),k=new j;c.default=k,b.exports=c.default},{3:3}],5:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a)}return e(a,[{key:"extend",value:function(a,b){if(a){var c=!!b&&b.override,d=!!b&&b.publicOnly;for(var e in a)!a.hasOwnProperty(e)||this[e]&&!c||d&&-1===a[e].indexOf("public_")||(this[e]=a[e])}}}]),a}();c.default=f,b.exports=c.default},{}],6:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a),this.init()}return e(a,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.FRAGMENTED_TEXT="fragmentedText",this.EMBEDDED_TEXT="embeddedText",this.MUXED="muxed",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.UTF8="utf-8",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma"}}]),a}(),g=new f;c.default=g,b.exports=c.default},{}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(1),h=d(g),i=function(){function a(){e(this,a)}return f(a,null,[{key:"findCencContentProtection",value:function(a){for(var b=null,c=0;c<a.length;++c){var d=a[c];"urn:mpeg:dash:mp4protection:2011"===d.schemeIdUri.toLowerCase()&&"cenc"===d.value.toLowerCase()&&(b=d)}return b}},{key:"getPSSHData",value:function(a){var b=8,c=new DataView(a),d=c.getUint8(b);return b+=20,d>0&&(b+=4+16*c.getUint32(b)),b+=4,a.slice(b)}},{key:"getPSSHForKeySystem",value:function(b,c){var d=a.parsePSSHList(c);return d.hasOwnProperty(b.uuid.toLowerCase())?d[b.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(a){return"pssh"in a?h.default.decodeArray(a.pssh.__text).buffer:null}},{key:"parsePSSHList",value:function(a){if(null===a)return[];for(var b=new DataView(a),c=!1,d={},e=0;!c;){var f=void 0,g=void 0,h=void 0,i=void 0,j=e;if(e>=b.buffer.byteLength)break;if(f=b.getUint32(e),g=e+f,e+=4,1886614376===b.getUint32(e))if(e+=4,0===(h=b.getUint8(e))||1===h){e++,e+=3,i="";var k=void 0,l=void 0;for(k=0;k<4;k++)l=b.getUint8(e+k).toString(16),i+=1===l.length?"0"+l:l;for(e+=4,i+="-",k=0;k<2;k++)l=b.getUint8(e+k).toString(16),i+=1===l.length?"0"+l:l;for(e+=2,i+="-",k=0;k<2;k++)l=b.getUint8(e+k).toString(16),i+=1===l.length?"0"+l:l;for(e+=2,i+="-",k=0;k<2;k++)l=b.getUint8(e+k).toString(16),i+=1===l.length?"0"+l:l;for(e+=2,i+="-",k=0;k<6;k++)l=b.getUint8(e+k).toString(16),i+=1===l.length?"0"+l:l;e+=6,i=i.toLowerCase(),b.getUint32(e),e+=4,d[i]=b.buffer.slice(j,g),e=g}else e=g;else e=g}return d}}]),a}();c.default=i,b.exports=c.default},{1:1}],8:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){var c=null,e=(0,i.default)(d).getInstance();e.setConfig({log:a.log}),e.initialize();var f=b(a);return!c&&f&&(c=(0,g.default)(d).create({protectionModel:f,protectionKeyController:e,adapter:a.adapter,eventBus:a.eventBus,log:a.log}),a.capabilities.setEncryptedMediaSupported(!0)),c}function b(a){var b=a.log,e=a.eventBus,f=a.errHandler,g=a.videoModel.getElement();return void 0!==g.onencrypted&&void 0!==g.mediaKeys&&void 0!==navigator.requestMediaKeySystemAccess&&"function"==typeof navigator.requestMediaKeySystemAccess?(b("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,m.default)(d).create({log:b,eventBus:e})):c(g,u)?(b("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,o.default)(d).create({log:b,eventBus:e,api:c(g,u)})):c(g,t)?(b("EME detected on this user agent! (ProtectionModel_01b)"),(0,q.default)(d).create({log:b,eventBus:e,errHandler:f,api:c(g,t)})):(b("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null)}function c(a,b){for(var c=0;c<b.length;c++){var d=b[c];if("function"==typeof a[d[Object.keys(d)[0]]])return d}return null}var d=this.context;return{createProtectionSystem:a}}Object.defineProperty(c,"__esModule",{value:!0});var f=a(10),g=d(f),h=a(11),i=d(h),j=a(9),k=d(j),l=a(16),m=d(l),n=a(17),o=d(n),p=a(15),q=d(p),r=a(2),s=d(r),t=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],u=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];e.__dashjs_factory_name="Protection";var v=s.default.getClassFactory(e);v.events=k.default,s.default.updateClassFactory(e.__dashjs_factory_name,v),c.default=v,b.exports=c.default},{10:10,11:11,15:15,16:16,17:17,2:2,9:9}],9:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;if(void 0===i)return;return i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return;a=j,b=f,c=g,d=!0,h=j=void 0}},h=a(5),i=d(h),j=function(a){function b(){e(this,b),g(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.INTERNAL_KEY_MESSAGE="internalKeyMessage",this.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",this.KEY_ADDED="public_keyAdded",this.KEY_ERROR="public_keyError",this.KEY_MESSAGE="public_keyMessage",this.KEY_SESSION_CLOSED="public_keySessionClosed",this.KEY_SESSION_CREATED="public_keySessionCreated",this.KEY_SESSION_REMOVED="public_keySessionRemoved",this.KEY_STATUSES_CHANGED="public_keyStatusesChanged",this.KEY_SYSTEM_ACCESS_COMPLETE="keySystemAccessComplete",this.KEY_SYSTEM_SELECTED="public_keySystemSelected",this.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",this.NEED_KEY="needkey",this.PROTECTION_CREATED="public_protectioncreated",this.PROTECTION_DESTROYED="public_protectiondestroyed",this.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",this.TEARDOWN_COMPLETE="protectionTeardownComplete",this.VIDEO_ELEMENT_SELECTED="videoElementSelected"}return f(b,a),b}(i.default),k=new j;c.default=k,b.exports=c.default},{5:5}],10:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(){G=A.getKeySystems(),H=[],L=!1,M="temporary",N="",k.default.extend(s.default.events)}function c(a,b,c){if(!L){var d=void 0;b||c||(d=C.getStreamsInfo()[0]),I=b||(d?C.getMediaInfoForType(d,g.default.AUDIO):null),J=c||(d?C.getMediaInfoForType(d,g.default.VIDEO):null);var e=J||I,f=A.getSupportedKeySystemsFromContentProtection(e.contentProtection);f&&f.length>0&&w(f,!0),L=!0}}function d(a){var b=i.default.getPSSHForKeySystem(O,a);if(b){for(var c=B.getAllInitData(),d=0;d<c.length;d++)if(A.initDataEquals(b,c[d]))return void E("DRM: Ignoring initData because we have already seen it!");try{B.createKeySession(b,M)}catch(e){D.trigger(k.default.KEY_SESSION_CREATED,{data:null,error:"Error creating key session! "+e.message})}}else D.trigger(k.default.KEY_SESSION_CREATED,{data:null,error:"Selected key system is "+O.systemString+".  needkey/encrypted event contains no initData corresponding to that key system!"})}function e(a){B.loadKeySession(a)}function f(a){B.removeKeySession(a)}function h(a){B.closeKeySession(a)}function j(a){B.setServerCertificate(a)}function l(a){a?(B.setMediaElement(a),D.on(k.default.NEED_KEY,z,this),D.on(k.default.INTERNAL_KEY_MESSAGE,y,this)):null===a&&(B.setMediaElement(a),D.off(k.default.NEED_KEY,z,this),D.off(k.default.INTERNAL_KEY_MESSAGE,y,this))}function n(a){M=a}function p(a){N=a}function q(a){K=a,A.setProtectionData(a)}function r(){l(null),O=void 0,B&&(B.reset(),B=null)}function t(a){var b=null,c=a.systemString;return K&&(b=c in K?K[c]:null),b}function v(a){var b=t(a),c=[],d=[],e=b&&b.audioRobustness&&b.audioRobustness.length>0?b.audioRobustness:N,f=b&&b.videoRobustness&&b.videoRobustness.length>0?b.videoRobustness:N;return I&&c.push(new m.default(I.codec,e)),J&&d.push(new m.default(J.codec,f)),new o.default(c,d,"optional","temporary"===M?"optional":"required",[M])}function w(a,b){var c=this,e=[],f=void 0;if(O){for(f=0;f<a.length;f++)if(O===a[f].ks){var g=function(){e.push({ks:a[f].ks,configs:[v(O)]});var g=function e(g){D.off(k.default.KEY_SYSTEM_ACCESS_COMPLETE,e,c),g.error?b||D.trigger(k.default.KEY_SYSTEM_SELECTED,{error:"DRM: KeySystem Access Denied! -- "+g.error}):(E("DRM: KeySystem Access Granted"),D.trigger(k.default.KEY_SYSTEM_SELECTED,{data:g.data}),d(a[f].initData))};return D.on(k.default.KEY_SYSTEM_ACCESS_COMPLETE,g,c),B.requestKeySystemAccess(e),"break"}();if("break"===g)break}}else if(void 0===O){var h;!function(){O=null,H.push(a);for(var g=0;g<a.length;g++)e.push({ks:a[g].ks,configs:[v(a[g].ks)]});var i=void 0,j=function a(d){D.off(k.default.KEY_SYSTEM_ACCESS_COMPLETE,a,c),d.error?(O=void 0,D.off(k.default.INTERNAL_KEY_SYSTEM_SELECTED,h,c),b||D.trigger(k.default.KEY_SYSTEM_SELECTED,{data:null,error:"DRM: KeySystem Access Denied! -- "+d.error})):(i=d.data,E("DRM: KeySystem Access Granted ("+i.keySystem.systemString+")!  Selecting key system..."),B.selectKeySystem(i))};h=function a(e){if(D.off(k.default.INTERNAL_KEY_SYSTEM_SELECTED,a,c),D.off(k.default.KEY_SYSTEM_ACCESS_COMPLETE,j,c),e.error)O=void 0,b||D.trigger(k.default.KEY_SYSTEM_SELECTED,{data:null,error:"DRM: Error selecting key system! -- "+e.error});else{O=B.getKeySystem(),D.trigger(k.default.KEY_SYSTEM_SELECTED,{data:i});var g=t(O);g&&g.serverCertificate&&g.serverCertificate.length>0&&B.setServerCertificate(u.default.decodeArray(g.serverCertificate).buffer);for(var h=0;h<H.length;h++)for(f=0;f<H[h].length;f++)if(O===H[h][f].ks){d(H[h][f].initData);break}}},D.on(k.default.INTERNAL_KEY_SYSTEM_SELECTED,h,c),D.on(k.default.KEY_SYSTEM_ACCESS_COMPLETE,j,c),B.requestKeySystemAccess(e)}()}else H.push(a)}function x(a,b){D.trigger(k.default.LICENSE_REQUEST_COMPLETE,{data:a,error:b})}function y(a){if(E("DRM: onKeyMessage"),a.error)return void E(a.error);var b=a.data;D.trigger(k.default.KEY_MESSAGE,{data:b});var c=b.messageType?b.messageType:"license-request",d=b.message,e=b.sessionToken,f=t(O),g=O.systemString,h=A.getLicenseServer(O,f,c),j={sessionToken:e,messageType:c};if(!h)return E("DRM: License server request not required for this message (type = "+a.data.messageType+").  Session ID = "+e.getSessionID()),void x(j);if(A.isClearKey(O)){var l=A.processClearKeyLicenseRequest(f,d);if(l)return E("DRM: ClearKey license request handled by application!"),x(j),void B.updateKeySession(e,l)}var m=new XMLHttpRequest,n=null;if(f&&f.serverURL){var o=f.serverURL;"string"==typeof o&&""!==o?n=o:"object"==typeof o&&o.hasOwnProperty(c)&&(n=o[c])}else f&&f.laURL&&""!==f.laURL?n=f.laURL:(n=O.getLicenseServerURLFromInitData(i.default.getPSSHData(e.initData)))||(n=a.data.laURL);if(!(n=h.getServerURLFromMessage(n,d,c)))return void x(j,"DRM: No license server URL specified!");m.open(h.getHTTPMethod(c),n,!0),m.responseType=h.getResponseType(g,c),m.onload=function(){200==this.status?(x(j),B.updateKeySession(e,h.getLicenseMessage(this.response,g,c))):x(j,"DRM: "+g+' update, XHR status is "'+this.statusText+'" ('+this.status+"), expected to be 200. readyState is "+this.readyState+".  Response is "+(this.response?h.getErrorResponse(this.response,g,c):"NONE"))},m.onabort=function(){x(j,"DRM: "+g+' update, XHR aborted. status is "'+this.statusText+'" ('+this.status+"), readyState is "+this.readyState)},m.onerror=function(){x(j,"DRM: "+g+' update, XHR error. status is "'+this.statusText+'" ('+this.status+"), readyState is "+this.readyState)};var p=function(a){var b=void 0;if(a)for(b in a)"authorization"===b.toLowerCase()&&(m.withCredentials=!0),m.setRequestHeader(b,a[b])};f&&p(f.httpRequestHeaders),p(O.getRequestHeadersFromMessage(d)),f&&f.withCredentials&&(m.withCredentials=!0),m.send(O.getLicenseRequestFromMessage(d))}function z(a){if(E("DRM: onNeedKey"),"cenc"!==a.key.initDataType)return void E("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+a.key.initDataType);var b=a.key.initData;ArrayBuffer.isView(b)&&(b=b.buffer),E("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(b)));var c=A.getSupportedKeySystems(b,K);if(0===c.length)return void E("DRM: Received needkey event with initData, but we don't support any of the key systems!");w(c,!1)}var A=a.protectionKeyController,B=a.protectionModel,C=a.adapter,D=a.eventBus,E=a.log,F=void 0,G=void 0,H=void 0,I=void 0,J=void 0,K=void 0,L=void 0,M=void 0,N=void 0,O=void 0;return F={initialize:c,createKeySession:d,loadKeySession:e,removeKeySession:f,closeKeySession:h,setServerCertificate:j,setMediaElement:l,setSessionType:n,setRobustnessLevel:p,setProtectionData:q,reset:r},b(),F}Object.defineProperty(c,"__esModule",{value:!0});var f=a(6),g=d(f),h=a(7),i=d(h),j=a(4),k=d(j),l=a(28),m=d(l),n=a(27),o=d(n),p=a(2),q=d(p),r=a(8),s=d(r),t=a(1),u=d(t);e.__dashjs_factory_name="ProtectionController",c.default=q.default.getClassFactory(e),b.exports=c.default},{1:1,2:2,27:27,28:28,4:4,6:6,7:7,8:8}],11:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){a&&a.log&&(t=a.log)}function b(){v=[];var a=void 0;a=(0,m.default)(r).getInstance(),v.push(a),a=(0,k.default)(r).getInstance(),v.push(a),a=(0,i.default)(r).getInstance(),v.push(a),w=a}function c(){return v}function d(a){for(var b=0;b<v.length;b++)if(v[b].systemString===a)return v[b];return null}function e(a){return a===w}function f(a,b){if(a.byteLength===b.byteLength){for(var c=new Uint8Array(a),d=new Uint8Array(b),e=0;e<c.length;e++)if(c[e]!==d[e])return!1;return!0}return!1}function h(a){var b=void 0,c=void 0,d=void 0,e=void 0,f=[];if(a)for(d=0;d<v.length;++d)for(c=v[d],e=0;e<a.length;++e)if(b=a[e],b.schemeIdUri.toLowerCase()===c.schemeIdURI){var g=c.getInitData(b);g&&f.push({ks:v[d],initData:g})}return f}function j(a,b){for(var c=[],d=g.default.parsePSSHList(a),e=0;e<v.length;++e){var f=v[e].systemString,h=!b||f in b;v[e].uuid in d&&h&&c.push({ks:v[e],initData:d[v[e].uuid]})}return c}function l(a,b,c){if("license-release"===c||"individualization-request"===c)return null;var d=null;return b&&b.hasOwnProperty("drmtoday")?d=(0,o.default)(r).getInstance():"com.widevine.alpha"===a.systemString?d=(0,s.default)(r).getInstance():"com.microsoft.playready"===a.systemString?d=(0,q.default)(r).getInstance():"org.w3.clearkey"===a.systemString&&(d=(0,u.default)(r).getInstance()),d}function n(a,b){try{return w.getClearKeysFromProtectionData(a,b)}catch(c){return t("Failed to retrieve clearkeys from ProtectionData"),null}}function p(a){for(var b=(function(b){var c=null;return a&&(c=b in a?a[b]:null),c}),c=0;c<v.length;c++){var d=v[c];d.hasOwnProperty("init")&&d.init(b(d.systemString))}}var r=this.context,t=void 0,v=void 0,w=void 0;return{initialize:b,setProtectionData:p,isClearKey:e,initDataEquals:f,getKeySystems:c,getKeySystemBySystemString:d,getSupportedKeySystemsFromContentProtection:h,getSupportedKeySystems:j,getLicenseServer:l,processClearKeyLicenseRequest:n,setConfig:a}}Object.defineProperty(c,"__esModule",{value:!0});var f=a(7),g=d(f),h=a(12),i=d(h),j=a(14),k=d(j),l=a(13),m=d(l),n=a(19),o=d(n),p=a(20),q=d(p),r=a(21),s=d(r),t=a(18),u=d(t),v=a(2),w=d(v);e.__dashjs_factory_name="ProtectionKeyController",c.default=w.default.getSingletonFactory(e),b.exports=c.default},{12:12,13:13,14:14,18:18,19:19,2:2,20:20,21:21,7:7}],12:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a,b){var c=null;if(a){for(var d=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(b))),e=[],f=0;f<d.kids.length;f++){var h=d.kids[f],j=a.clearkeys.hasOwnProperty(h)?a.clearkeys[h]:null;if(!j)throw new Error("DRM: ClearKey keyID ("+h+") is not known!");e.push(new g.default(h,j))}c=new i.default(e)}return c}function b(a){return k.default.parseInitDataFromContentProtection(a)}function c(){return null}function d(a){return new Uint8Array(a)}function e(){return null}return{uuid:n,schemeIdURI:p,systemString:o,getInitData:b,getRequestHeadersFromMessage:c,getLicenseRequestFromMessage:d,getLicenseServerURLFromInitData:e,getClearKeysFromProtectionData:a}}Object.defineProperty(c,"__esModule",{value:!0});var f=a(25),g=d(f),h=a(22),i=d(h),j=a(7),k=d(j),l=a(2),m=d(l),n="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",o="org.w3.clearkey",p="urn:uuid:"+n;e.__dashjs_factory_name="KeySystemClearKey",c.default=m.default.getSingletonFactory(e),b.exports=c.default},{2:2,22:22,25:25,7:7}],13:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){var b=void 0,c=void 0,d={},e=new DOMParser,g="utf16"===f?new Uint16Array(a):new Uint8Array(a);b=String.fromCharCode.apply(null,g),c=e.parseFromString(b,"application/xml");for(var h=c.getElementsByTagName("name"),i=c.getElementsByTagName("value"),j=0;j<h.length;j++)d[h[j].childNodes[0].nodeValue]=i[j].childNodes[0].nodeValue;return d.hasOwnProperty("Content")&&(d["Content-Type"]=d.Content,delete d.Content),d}function b(a){var b=void 0,c=void 0,d=null,e=new DOMParser,g="utf16"===f?new Uint16Array(a):new Uint8Array(a);if(b=String.fromCharCode.apply(null,g),c=e.parseFromString(b,"application/xml"),c.getElementsByTagName("Challenge")[0]){var h=c.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;h&&(d=k.default.decode(h))}return d}function c(a){if(a)for(var b=new DataView(a),c=b.getUint16(4,!0),d=6,e=new DOMParser,f=0;f<c;f++){var g=b.getUint16(d,!0);d+=2;var h=b.getUint16(d,!0);if(d+=2,1===g){var i=a.slice(d,d+h),j=String.fromCharCode.apply(null,new Uint16Array(i)),k=e.parseFromString(j,"application/xml");if(k.getElementsByTagName("LA_URL")[0]){var l=k.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(l)return l}if(k.getElementsByTagName("LUI_URL")[0]){var m=k.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(m)return m}}else d+=h}return null}function d(a){var b=new Uint8Array([112,115,115,104,0,0,0,0]),c=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),d=0,e=null,f=void 0,h=void 0,i=void 0,j=void 0,l=void 0;if("pssh"in a)return g.default.parseInitDataFromContentProtection(a);if("pro"in a)e=k.default.decodeArray(a.pro.__text);else{if(!("prheader"in a))return null;e=k.default.decodeArray(a.prheader.__text)}return f=e.length,h=4+b.length+c.length+4+f,i=new ArrayBuffer(h),j=new Uint8Array(i),l=new DataView(i),l.setUint32(d,h),d+=4,j.set(b,d),d+=b.length,j.set(c,d),d+=c.length,l.setUint32(d,f),d+=4,j.set(e,d),d+=f,j.buffer}function e(a){if("utf8"!==a&&"utf16"!==a)throw new Error("Illegal PlayReady message format! -- "+a);f=a}var f="utf16";return{uuid:l,schemeIdURI:n,systemString:m,getInitData:d,getRequestHeadersFromMessage:a,getLicenseRequestFromMessage:b,getLicenseServerURLFromInitData:c,setPlayReadyMessageFormat:e}}Object.defineProperty(c,"__esModule",{value:!0});var f=a(7),g=d(f),h=a(2),i=d(h),j=a(1),k=d(j),l="9a04f079-9840-4286-ab92-e65be0885f95",m="com.microsoft.playready",n="urn:uuid:"+l;e.__dashjs_factory_name="KeySystemPlayReady",c.default=i.default.getSingletonFactory(e),b.exports=c.default},{1:1,2:2,7:7}],14:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){a&&(h=a)}function b(a,b){var c=void 0,d=!0,e=16,f=void 0,g=void 0,h=void 0;for(c=new Uint8Array(a),g=0;g<=c.length-(e+2);g++)if(18===c[g]&&16===c[g+1]){for(f=g+2,h=f;h<f+e;h++)if(255!==c[h]){d=!1;break}break}return d&&c.set(b,f),c.buffer}function c(a){var c=null;return c=h&&h.pssh?k.default.decodeArray(h.pssh).buffer:g.default.parseInitDataFromContentProtection(a),c&&(c=b(c,a["cenc:default_KID"])),c}function d(){return null}function e(a){return new Uint8Array(a)}function f(){return null}var h=null;return{uuid:l,schemeIdURI:n,systemString:m,init:a,getInitData:c,getRequestHeadersFromMessage:d,getLicenseRequestFromMessage:e,getLicenseServerURLFromInitData:f}}Object.defineProperty(c,"__esModule",{value:!0});var f=a(7),g=d(f),h=a(2),i=d(h),j=a(1),k=d(j),l="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",m="com.widevine.alpha",n="urn:uuid:"+l;e.__dashjs_factory_name="KeySystemWidevine",c.default=i.default.getSingletonFactory(e),b.exports=c.default},{1:1,2:2,7:7}],15:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(){E=null,F=null,H=[],I=[],G=(0,g.default)(y).getInstance(),K=v()}function c(){E&&x();for(var a=0;a<I.length;a++)p(I[a]);z.trigger(s.default.TEARDOWN_COMPLETE)}function d(){return F}function e(){for(var a=[],b=0;b<H.length;b++)a.push(H[b].initData);for(var b=0;b<I.length;b++)a.push(I[b].initData);return a}function f(a){var b=E;b||(b=document.createElement("video"));for(var c=!1,d=0;d<a.length;d++)for(var e=a[d].ks.systemString,f=a[d].configs,g=null,h=null,i=0;i<f.length;i++){var j=f[i].videoCapabilities;if(j&&0!==j.length){h=[];for(var k=0;k<j.length;k++)""!==b.canPlayType(j[k].contentType,e)&&h.push(j[k])}if(!(!g&&!h||g&&0===g.length||h&&0===h.length)){c=!0;var l=new o.default(g,h),m=G.getKeySystemBySystemString(e);z.trigger(s.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:new q.default(m,l)});break}}c||z.trigger(s.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}
function h(a){F=a.keySystem,z.trigger(s.default.INTERNAL_KEY_SYSTEM_SELECTED)}function j(a){E!==a&&(E&&x(),(E=a)&&(E.addEventListener(B.keyerror,K),E.addEventListener(B.needkey,K),E.addEventListener(B.keymessage,K),E.addEventListener(B.keyadded,K),z.trigger(s.default.VIDEO_ELEMENT_SELECTED)))}function l(a){if(!F)throw new Error("Can not create sessions until you have selected a key system");if(J||0===I.length){var b={sessionID:null,initData:a,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return H.push(b),E[B.generateKeyRequest](F.systemString,new Uint8Array(a)),b}throw new Error("Multiple sessions not allowed!")}function n(a,b){var c=a.sessionID;if(G.isClearKey(F))for(var d=0;d<b.keyPairs.length;d++)E[B.addKey](F.systemString,b.keyPairs[d].key,b.keyPairs[d].keyID,c);else E[B.addKey](F.systemString,new Uint8Array(b),a.initData,c)}function p(a){E[B.cancelKeyRequest](F.systemString,a.sessionID)}function r(){}function t(){}function u(){}function v(){return{handleEvent:function(a){var b=null;switch(a.type){case B.needkey:var c=ArrayBuffer.isView(a.initData)?a.initData.buffer:a.initData;z.trigger(s.default.NEED_KEY,{key:new i.default(c,"cenc")});break;case B.keyerror:if(b=w(I,a.sessionId),b||(b=w(H,a.sessionId)),b){var d="";switch(a.errorCode.code){case 1:d+="MEDIA_KEYERR_UNKNOWN - An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:d+="MEDIA_KEYERR_CLIENT - The Key System could not be installed or updated.";break;case 3:d+="MEDIA_KEYERR_SERVICE - The message passed into update indicated an error from the license service.";break;case 4:d+="MEDIA_KEYERR_OUTPUT - There is no available output device with the required characteristics for the content protection system.";break;case 5:d+="MEDIA_KEYERR_HARDWARECHANGE - A hardware configuration change caused a content protection error.";break;case 6:d+="MEDIA_KEYERR_DOMAIN - An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain."}d+="  System Code = "+a.systemCode,z.trigger(s.default.KEY_ERROR,{data:new k.default(b,d)})}else A("No session token found for key error");break;case B.keyadded:b=w(I,a.sessionId),b||(b=w(H,a.sessionId)),b?(A("DRM: Key added."),z.trigger(s.default.KEY_ADDED,{data:b})):A("No session token found for key added");break;case B.keymessage:if(J=null!==a.sessionId&&void 0!==a.sessionId,J?!(b=w(I,a.sessionId))&&H.length>0&&(b=H.shift(),I.push(b),b.sessionID=a.sessionId):H.length>0&&(b=H.shift(),I.push(b),0!==H.length&&C.mediaKeyMessageError("Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!")),b){var e=ArrayBuffer.isView(a.message)?a.message.buffer:a.message;b.keyMessage=e,z.trigger(s.default.INTERNAL_KEY_MESSAGE,{data:new m.default(b,e,a.defaultURL)})}else A("No session token found for key message")}}}}function w(a,b){if(b&&a){for(var c=a.length,d=0;d<c;d++)if(a[d].sessionID==b)return a[d];return null}return null}function x(){E.removeEventListener(B.keyerror,K),E.removeEventListener(B.needkey,K),E.removeEventListener(B.keymessage,K),E.removeEventListener(B.keyadded,K)}var y=this.context,z=a.eventBus,A=a.log,B=a.api,C=a.errHandler,D=void 0,E=void 0,F=void 0,G=void 0,H=void 0,I=void 0,J=void 0,K=void 0;return D={getAllInitData:e,requestKeySystemAccess:f,getKeySystem:d,selectKeySystem:h,setMediaElement:j,createKeySession:l,updateKeySession:n,closeKeySession:p,setServerCertificate:r,loadKeySession:t,removeKeySession:u,reset:c},b(),D}Object.defineProperty(c,"__esModule",{value:!0});var f=a(11),g=d(f),h=a(29),i=d(h),j=a(23),k=d(j),l=a(24),m=d(l),n=a(27),o=d(n),p=a(26),q=d(p),r=a(4),s=d(r),t=a(2),u=d(t);e.__dashjs_factory_name="ProtectionModel_01b",c.default=u.default.getClassFactory(e),b.exports=c.default},{11:11,2:2,23:23,24:24,26:26,27:27,29:29,4:4}],16:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(){D=null,E=null,F=null,G=[],I=(0,g.default)(z).getInstance(),H=w()}function c(){var a=G.length,b=void 0;0!==a?function(){for(var c=function(a){x(a),0===G.length&&(E?(E.removeEventListener("encrypted",H),E.setMediaKeys(null).then(function(){A.trigger(q.default.TEARDOWN_COMPLETE)})):A.trigger(q.default.TEARDOWN_COMPLETE))},d=0;d<a;d++)b=G[d],function(a){b.session.closed.then(function(){c(a)}),v(b).catch(function(){c(a)})}(b)}():A.trigger(q.default.TEARDOWN_COMPLETE)}function d(){return D}function e(){for(var a=[],b=0;b<G.length;b++)a.push(G[b].initData);return a}function f(a){u(a,0)}function h(a){a.mksa.createMediaKeys().then(function(b){D=a.keySystem,F=b,E&&E.setMediaKeys(F).then(function(){A.trigger(q.default.INTERNAL_KEY_SYSTEM_SELECTED)})}).catch(function(){A.trigger(q.default.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+a.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})}function j(a){E!==a&&(E&&(E.removeEventListener("encrypted",H),E.setMediaKeys(null)),(E=a)&&(E.addEventListener("encrypted",H),F&&E.setMediaKeys(F)))}function l(a){if(!D||!F)throw new Error("Can not set server certificate until you have selected a key system");F.setServerCertificate(a).then(function(){B("DRM: License server certificate successfully updated."),A.trigger(q.default.SERVER_CERTIFICATE_UPDATED)}).catch(function(a){A.trigger(q.default.SERVER_CERTIFICATE_UPDATED,{error:"Error updating server certificate -- "+a.name})})}function n(a,b){if(!D||!F)throw new Error("Can not create sessions until you have selected a key system");var c=F.createSession(b),d=y(c,a,b);c.generateRequest("cenc",a).then(function(){B("DRM: Session created.  SessionID = "+d.getSessionID()),A.trigger(q.default.KEY_SESSION_CREATED,{data:d})}).catch(function(a){x(d),A.trigger(q.default.KEY_SESSION_CREATED,{data:null,error:"Error generating key request -- "+a.name})})}function p(a,b){var c=a.session;I.isClearKey(D)&&(b=b.toJWK()),c.update(b).catch(function(b){A.trigger(q.default.KEY_ERROR,{data:new k.default(a,"Error sending update() message! "+b.name)})})}function r(a){if(!D||!F)throw new Error("Can not load sessions until you have selected a key system");var b=F.createSession();b.load(a).then(function(c){if(c){var d=y(b);B("DRM: Session created.  SessionID = "+d.getSessionID()),A.trigger(q.default.KEY_SESSION_CREATED,{data:d})}else A.trigger(q.default.KEY_SESSION_CREATED,{data:null,error:"Could not load session! Invalid Session ID ("+a+")"})}).catch(function(b){A.trigger(q.default.KEY_SESSION_CREATED,{data:null,error:"Could not load session ("+a+")! "+b.name})})}function s(a){a.session.remove().then(function(){B("DRM: Session removed.  SessionID = "+a.getSessionID()),A.trigger(q.default.KEY_SESSION_REMOVED,{data:a.getSessionID()})},function(b){A.trigger(q.default.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+a.getSessionID()+"). "+b.name})})}function t(a){v(a).catch(function(b){x(a),A.trigger(q.default.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+a.getSessionID()+") "+b.name})})}function u(a,b){!function(b){var c=a[b].ks,d=a[b].configs;navigator.requestMediaKeySystemAccess(c.systemString,d).then(function(a){var b="function"==typeof a.getConfiguration?a.getConfiguration():null,d=new o.default(c,b);d.mksa=a,A.trigger(q.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:d})}).catch(function(){++b<a.length?u(a,b):A.trigger(q.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied!"})})}(b)}function v(a){var b=a.session;return b.removeEventListener("keystatuseschange",a),b.removeEventListener("message",a),b.close()}function w(){return{handleEvent:function(a){switch(a.type){case"encrypted":if(a.initData){var b=ArrayBuffer.isView(a.initData)?a.initData.buffer:a.initData;A.trigger(q.default.NEED_KEY,{key:new i.default(b,a.initDataType)})}}}}}function x(a){for(var b=0;b<G.length;b++)if(G[b]===a){G.splice(b,1);break}}function y(a,b,c){var d={session:a,initData:b,handleEvent:function(a){switch(a.type){case"keystatuseschange":A.trigger(q.default.KEY_STATUSES_CHANGED,{data:this});break;case"message":var b=ArrayBuffer.isView(a.message)?a.message.buffer:a.message;A.trigger(q.default.INTERNAL_KEY_MESSAGE,{data:new m.default(this,b,void 0,a.messageType)})}},getSessionID:function(){return a.sessionId},getExpirationTime:function(){return a.expiration},getKeyStatuses:function(){return a.keyStatuses},getSessionType:function(){return c}};return a.addEventListener("keystatuseschange",d),a.addEventListener("message",d),a.closed.then(function(){x(d),B("DRM: Session closed.  SessionID = "+d.getSessionID()),A.trigger(q.default.KEY_SESSION_CLOSED,{data:d.getSessionID()})}),G.push(d),d}var z=this.context,A=a.eventBus,B=a.log,C=void 0,D=void 0,E=void 0,F=void 0,G=void 0,H=void 0,I=void 0;return C={getAllInitData:e,requestKeySystemAccess:f,getKeySystem:d,selectKeySystem:h,setMediaElement:j,setServerCertificate:l,createKeySession:n,updateKeySession:p,loadKeySession:r,removeKeySession:s,closeKeySession:t,reset:c},b(),C}Object.defineProperty(c,"__esModule",{value:!0});var f=a(11),g=d(f),h=a(29),i=d(h),j=a(23),k=d(j),l=a(24),m=d(l),n=a(26),o=d(n),p=a(4),q=d(p),r=a(2),s=d(r);e.__dashjs_factory_name="ProtectionModel_21Jan2015",c.default=s.default.getClassFactory(e),b.exports=c.default},{11:11,2:2,23:23,24:24,26:26,29:29,4:4}],17:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(){D=null,E=null,F=null,G=null,H=[],J=(0,g.default)(y).getInstance(),I=v()}function c(){try{for(var a=0;a<H.length;a++)p(H[a]);D&&D.removeEventListener(B.needkey,I),z.trigger(s.default.TEARDOWN_COMPLETE)}catch(b){z.trigger(s.default.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+b.message})}}function d(){return E}function e(){for(var a=[],b=0;b<H.length;b++)a.push(H[b].initData);return a}function f(a){for(var b=!1,c=0;c<a.length;c++)for(var d=a[c].ks.systemString,e=a[c].configs,f=null,g=null,h=0;h<e.length;h++){var i=e[h].audioCapabilities,j=e[h].videoCapabilities;if(i&&0!==i.length){f=[];for(var k=0;k<i.length;k++)window[B.MediaKeys].isTypeSupported(d,i[k].contentType)&&f.push(i[k])}if(j&&0!==j.length){g=[];for(var l=0;l<j.length;l++)window[B.MediaKeys].isTypeSupported(d,j[l].contentType)&&g.push(j[l])}if(!(!f&&!g||f&&0===f.length||g&&0===g.length)){b=!0;var m=new o.default(f,g),n=J.getKeySystemBySystemString(d);z.trigger(s.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:new q.default(n,m)});break}}b||z.trigger(s.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}function h(a){try{F=a.mediaKeys=new window[B.MediaKeys](a.keySystem.systemString),E=a.keySystem,G=a,D&&w(),z.trigger(s.default.INTERNAL_KEY_SYSTEM_SELECTED)}catch(b){z.trigger(s.default.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+E.systemString+")! Could not create MediaKeys -- TODO"})}}function j(a){D!==a&&(D&&D.removeEventListener(B.needkey,I),(D=a)&&(D.addEventListener(B.needkey,I),F&&w()))}function l(a){if(!E||!F||!G)throw new Error("Can not create sessions until you have selected a key system");var b=null;if(null!==G.ksConfiguration.videoCapabilities&&G.ksConfiguration.videoCapabilities.length>0&&(b=G.ksConfiguration.videoCapabilities[0]),null===b&&null!==G.ksConfiguration.audioCapabilities&&G.ksConfiguration.audioCapabilities.length>0&&(b=G.ksConfiguration.audioCapabilities[0]),null===b)throw new Error("Can not create sessions for unknown content types.");var c=b.contentType,d=F.createSession(c,new Uint8Array(a)),e=x(d,a);d.addEventListener(B.error,e),d.addEventListener(B.message,e),d.addEventListener(B.ready,e),d.addEventListener(B.close,e),H.push(e),A("DRM: Session created.  SessionID = "+e.getSessionID()),z.trigger(s.default.KEY_SESSION_CREATED,{data:e})}function n(a,b){var c=a.session;J.isClearKey(E)?c.update(new Uint8Array(b.toJWK())):c.update(new Uint8Array(b))}function p(a){var b=a.session;b.removeEventListener(B.error,a),b.removeEventListener(B.message,a),b.removeEventListener(B.ready,a),b.removeEventListener(B.close,a);for(var c=0;c<H.length;c++)if(H[c]===a){H.splice(c,1);break}b[B.release]()}function r(){}function t(){}function u(){}function v(){return{handleEvent:function(a){switch(a.type){case B.needkey:if(a.initData){var b=ArrayBuffer.isView(a.initData)?a.initData.buffer:a.initData;z.trigger(s.default.NEED_KEY,{key:new i.default(b,"cenc")})}}}}}function w(){var a=null,b=function(){D.removeEventListener("loadedmetadata",a),D[B.setMediaKeys](F),z.trigger(s.default.VIDEO_ELEMENT_SELECTED)};D.readyState>=1?b():(a=b.bind(this),D.addEventListener("loadedmetadata",a))}function x(a,b){return{session:a,initData:b,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(a){switch(a.type){case B.error:z.trigger(s.default.KEY_ERROR,{data:new k.default(this,"KeyError")});break;case B.message:var b=ArrayBuffer.isView(a.message)?a.message.buffer:a.message;z.trigger(s.default.INTERNAL_KEY_MESSAGE,{data:new m.default(this,b,a.destinationURL)});break;case B.ready:A("DRM: Key added."),z.trigger(s.default.KEY_ADDED);break;case B.close:A("DRM: Session closed.  SessionID = "+this.getSessionID()),z.trigger(s.default.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}var y=this.context,z=a.eventBus,A=a.log,B=a.api,C=void 0,D=void 0,E=void 0,F=void 0,G=void 0,H=void 0,I=void 0,J=void 0;return C={getAllInitData:e,requestKeySystemAccess:f,getKeySystem:d,selectKeySystem:h,setMediaElement:j,createKeySession:l,updateKeySession:n,closeKeySession:p,setServerCertificate:r,loadKeySession:t,removeKeySession:u,reset:c},b(),C}Object.defineProperty(c,"__esModule",{value:!0});var f=a(11),g=d(f),h=a(29),i=d(h),j=a(23),k=d(j),l=a(24),m=d(l),n=a(27),o=d(n),p=a(26),q=d(p),r=a(4),s=d(r),t=a(2),u=d(t);e.__dashjs_factory_name="ProtectionModel_3Feb2014",c.default=u.default.getClassFactory(e),b.exports=c.default},{11:11,2:2,23:23,24:24,26:26,27:27,29:29,4:4}],18:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a,b){var c=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(b)));a+="/?";for(var d=0;d<c.kids.length;d++)a+=c.kids[d]+"&";return a=a.substring(0,a.length-1)}function b(){return"GET"}function c(){return"json"}function d(a){if(!a.hasOwnProperty("keys"))return null;for(var b=[],c=0;c<a.keys.length;c++){var d=a.keys[c],e=d.kid.replace(/=/g,""),f=d.k.replace(/=/g,"");b.push(new g.default(e,f))}return new i.default(b)}function e(a){return String.fromCharCode.apply(null,new Uint8Array(a))}return{getServerURLFromMessage:a,getHTTPMethod:b,getResponseType:c,getLicenseMessage:d,getErrorResponse:e}}Object.defineProperty(c,"__esModule",{value:!0});var f=a(25),g=d(f),h=a(22),i=d(h),j=a(2),k=d(j);e.__dashjs_factory_name="ClearKey",c.default=k.default.getSingletonFactory(e),b.exports=c.default},{2:2,22:22,25:25}],19:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){return a}function b(){return"POST"}function c(a){return f[a].responseType}function d(a,b){return f[b].getLicenseMessage(a)}function e(a,b){return f[b].getErrorResponse(a)}var f={"com.widevine.alpha":{responseType:"json",getLicenseMessage:function(a){return i.default.decodeArray(a.license)},getErrorResponse:function(a){return a}},"com.microsoft.playready":{responseType:"arraybuffer",getLicenseMessage:function(a){return a},getErrorResponse:function(a){return String.fromCharCode.apply(null,new Uint8Array(a))}}};return{getServerURLFromMessage:a,getHTTPMethod:b,getResponseType:c,getLicenseMessage:d,getErrorResponse:e}}Object.defineProperty(c,"__esModule",{value:!0});var f=a(2),g=d(f),h=a(1),i=d(h);e.__dashjs_factory_name="DRMToday",c.default=g.default.getSingletonFactory(e),b.exports=c.default},{1:1,2:2}],20:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){return a}function b(){return"POST"}function c(){return"arraybuffer"}function d(a){return a}function e(a){return String.fromCharCode.apply(null,new Uint8Array(a))}return{getServerURLFromMessage:a,getHTTPMethod:b,getResponseType:c,getLicenseMessage:d,getErrorResponse:e}}Object.defineProperty(c,"__esModule",{value:!0});var f=a(2),g=d(f);e.__dashjs_factory_name="PlayReady",c.default=g.default.getSingletonFactory(e),b.exports=c.default},{2:2}],21:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){return a}function b(){return"POST"}function c(){return"arraybuffer"}function d(a){return a}function e(a){return String.fromCharCode.apply(null,new Uint8Array(a))}return{getServerURLFromMessage:a,getHTTPMethod:b,getResponseType:c,getLicenseMessage:d,getErrorResponse:e}}Object.defineProperty(c,"__esModule",{value:!0});var f=a(2),g=d(f);e.__dashjs_factory_name="Widevine",c.default=g.default.getSingletonFactory(e),b.exports=c.default},{2:2}],22:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,c){if(d(this,a),c&&"persistent"!==c&&"temporary"!==c)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=b,this.type=c}return e(a,[{key:"toJWK",value:function(){var a=void 0,b=this.keyPairs.length,c={keys:[]};for(a=0;a<b;a++){var d={kty:"oct",alg:"A128KW",kid:this.keyPairs[a].keyID,k:this.keyPairs[a].key};c.keys.push(d)}this.type&&(c.type=this.type);var e=JSON.stringify(c),f=e.length,g=new ArrayBuffer(f),h=new Uint8Array(g);for(a=0;a<f;a++)h[a]=e.charCodeAt(a);return g}}]),a}();c.default=f,b.exports=c.default},{}],23:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function a(b,c){d(this,a),this.sessionToken=b,this.error=c};c.default=e,b.exports=c.default},{}],24:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function a(b,c,e,f){d(this,a),this.sessionToken=b,this.message=c,this.defaultURL=e,this.messageType=f||"license-request"};c.default=e,b.exports=c.default},{}],25:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function a(b,c){d(this,a),this.keyID=b,this.key=c};c.default=e,b.exports=c.default},{}],26:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function a(b,c){d(this,a),this.keySystem=b,this.ksConfiguration=c};c.default=e,b.exports=c.default},{}],27:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function a(b,c,e,f,g){d(this,a),this.initDataTypes=["cenc"],b&&b.length&&(this.audioCapabilities=b),c&&c.length&&(this.videoCapabilities=c),this.distinctiveIdentifier=e,this.persistentState=f,this.sessionTypes=g};c.default=e,b.exports=c.default},{}],28:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function a(b,c){d(this,a),this.contentType=b,this.robustness=c};c.default=e,b.exports=c.default},{}],29:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function a(b,c){d(this,a),this.initData=b,this.initDataType=c};c.default=e,b.exports=c.default},{}]},{},[8])(8)});
//# sourceMappingURL=dash.protection.min.js.map