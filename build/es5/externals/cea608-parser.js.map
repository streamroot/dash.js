{"version":3,"sources":["../../../externals/cea608-parser.js"],"names":[],"mappings":"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","file":"cea608-parser.js","sourcesContent":["/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2015-2016, DASH Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  1. Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  2. Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n(function(exports) {\n\n    \"use strict\";\n\n    /**\n     *  Exceptions from regular ASCII. CodePoints are mapped to UTF-16 codes\n     */\n\n    var specialCea608CharsCodes = {\n        0x2a : 0xe1, // lowercase a, acute accent\n        0x5c : 0xe9, // lowercase e, acute accent\n        0x5e : 0xed, // lowercase i, acute accent\n        0x5f : 0xf3, // lowercase o, acute accent\n        0x60 : 0xfa, // lowercase u, acute accent\n        0x7b : 0xe7, // lowercase c with cedilla\n        0x7c : 0xf7, // division symbol\n        0x7d : 0xd1, // uppercase N tilde\n        0x7e : 0xf1, // lowercase n tilde\n        0x7f : 0x2588, // Full block\n        // THIS BLOCK INCLUDES THE 16 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n        // THAT COME FROM HI BYTE=0x11 AND LOW BETWEEN 0x30 AND 0x3F\n        // THIS MEANS THAT \\x50 MUST BE ADDED TO THE VALUES\n        0x80 : 0xae, // Registered symbol (R)\n        0x81 : 0xb0, // degree sign\n        0x82 : 0xbd, // 1/2 symbol\n        0x83 : 0xbf, // Inverted (open) question mark\n        0x84 : 0x2122, // Trademark symbol (TM)\n        0x85 : 0xa2, // Cents symbol\n        0x86 : 0xa3, // Pounds sterling\n        0x87 : 0x266a, // Music 8'th note\n        0x88 : 0xe0, // lowercase a, grave accent\n        0x89 : 0x20, // transparent space (regular)\n        0x8a : 0xe8, // lowercase e, grave accent\n        0x8b : 0xe2, // lowercase a, circumflex accent\n        0x8c : 0xea, // lowercase e, circumflex accent\n        0x8d : 0xee, // lowercase i, circumflex accent\n        0x8e : 0xf4, // lowercase o, circumflex accent\n        0x8f : 0xfb, // lowercase u, circumflex accent\n        // THIS BLOCK INCLUDES THE 32 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n        // THAT COME FROM HI BYTE=0x12 AND LOW BETWEEN 0x20 AND 0x3F\n        0x90 : 0xc1, // capital letter A with acute\n        0x91 : 0xc9, // capital letter E with acute\n        0x92 : 0xd3, // capital letter O with acute\n        0x93 : 0xda, // capital letter U with acute\n        0x94 : 0xdc, // capital letter U with diaresis\n        0x95 : 0xfc, // lowercase letter U with diaeresis\n        0x96 : 0x2018, // opening single quote\n        0x97 : 0xa1, // inverted exclamation mark\n        0x98 : 0x2a, // asterisk\n        0x99 : 0x2019, // closing single quote\n        0x9a : 0x2501, // box drawings heavy horizontal\n        0x9b : 0xa9, // copyright sign\n        0x9c : 0x2120, // Service mark\n        0x9d : 0x2022, // (round) bullet\n        0x9e : 0x201c, // Left double quotation mark\n        0x9f : 0x201d, // Right double quotation mark\n        0xa0 : 0xc0, // uppercase A, grave accent\n        0xa1 : 0xc2, // uppercase A, circumflex\n        0xa2 : 0xc7, // uppercase C with cedilla\n        0xa3 : 0xc8, // uppercase E, grave accent\n        0xa4 : 0xca, // uppercase E, circumflex\n        0xa5 : 0xcb, // capital letter E with diaresis\n        0xa6 : 0xeb, // lowercase letter e with diaresis\n        0xa7 : 0xce, // uppercase I, circumflex\n        0xa8 : 0xcf, // uppercase I, with diaresis\n        0xa9 : 0xef, // lowercase i, with diaresis\n        0xaa : 0xd4, // uppercase O, circumflex\n        0xab : 0xd9, // uppercase U, grave accent\n        0xac : 0xf9, // lowercase u, grave accent\n        0xad : 0xdb, // uppercase U, circumflex\n        0xae : 0xab, // left-pointing double angle quotation mark\n        0xaf : 0xbb, // right-pointing double angle quotation mark\n        // THIS BLOCK INCLUDES THE 32 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n        // THAT COME FROM HI BYTE=0x13 AND LOW BETWEEN 0x20 AND 0x3F\n        0xb0 : 0xc3, // Uppercase A, tilde\n        0xb1 : 0xe3, // Lowercase a, tilde\n        0xb2 : 0xcd, // Uppercase I, acute accent\n        0xb3 : 0xcc, // Uppercase I, grave accent\n        0xb4 : 0xec, // Lowercase i, grave accent\n        0xb5 : 0xd2, // Uppercase O, grave accent\n        0xb6 : 0xf2, // Lowercase o, grave accent\n        0xb7 : 0xd5, // Uppercase O, tilde\n        0xb8 : 0xf5, // Lowercase o, tilde\n        0xb9 : 0x7b, // Open curly brace\n        0xba : 0x7d, // Closing curly brace\n        0xbb : 0x5c, // Backslash\n        0xbc : 0x5e, // Caret\n        0xbd : 0x5f, // Underscore\n        0xbe : 0x7c, // Pipe (vertical line)\n        0xbf : 0x223c, // Tilde operator\n        0xc0 : 0xc4, // Uppercase A, umlaut\n        0xc1 : 0xe4, // Lowercase A, umlaut\n        0xc2 : 0xd6, // Uppercase O, umlaut\n        0xc3 : 0xf6, // Lowercase o, umlaut\n        0xc4 : 0xdf, // Esszett (sharp S)\n        0xc5 : 0xa5, // Yen symbol\n        0xc6 : 0xa4, // Generic currency sign\n        0xc7 : 0x2503, // Box drawings heavy vertical\n        0xc8 : 0xc5, // Uppercase A, ring\n        0xc9 : 0xe5, // Lowercase A, ring\n        0xca : 0xd8, // Uppercase O, stroke\n        0xcb : 0xf8, // Lowercase o, strok\n        0xcc : 0x250f, // Box drawings heavy down and right\n        0xcd : 0x2513, // Box drawings heavy down and left\n        0xce : 0x2517, // Box drawings heavy up and right\n        0xcf : 0x251b // Box drawings heavy up and left\n    };\n\n    /**\n     * Get Unicode Character from CEA-608 byte code\n     */\n    var getCharForByte = function(byte) {\n        var charCode = byte;\n        if (specialCea608CharsCodes.hasOwnProperty(byte)) {\n            charCode = specialCea608CharsCodes[byte];\n        }\n        return String.fromCharCode(charCode);\n    };\n\n    var NR_ROWS = 15,\n        NR_COLS = 32;\n    // Tables to look up row from PAC data\n    var rowsLowCh1 = {0x11 : 1, 0x12 : 3, 0x15 : 5, 0x16 : 7, 0x17 : 9, 0x10 : 11, 0x13 : 12, 0x14 : 14};\n    var rowsHighCh1 = {0x11 : 2, 0x12 : 4, 0x15 : 6, 0x16 : 8, 0x17 : 10, 0x13 : 13, 0x14 : 15};\n    var rowsLowCh2 = {0x19 : 1, 0x1A : 3, 0x1D : 5, 0x1E : 7, 0x1F : 9, 0x18 : 11, 0x1B : 12, 0x1C : 14};\n    var rowsHighCh2 = {0x19 : 2, 0x1A : 4, 0x1D : 6, 0x1E : 8, 0x1F : 10, 0x1B : 13, 0x1C : 15};\n\n    var backgroundColors = ['white', 'green', 'blue', 'cyan', 'red', 'yellow', 'magenta', 'black', 'transparent'];\n\n    /**\n     * Simple logger class to be able to write with time-stamps and filter on level.\n     */\n    var logger = {\n        verboseFilter : {'DATA' : 3, 'DEBUG' : 3, 'INFO' : 2, 'WARNING' : 2, 'TEXT' : 1, 'ERROR' : 0},\n        time : null,\n        verboseLevel : 0, // Only write errors\n        setTime : function(newTime) {\n            this.time = newTime;\n        },\n        log : function(severity, msg) {\n            var minLevel = this.verboseFilter[severity];\n            if (this.verboseLevel >= minLevel) {\n                console.log(this.time + \" [\" + severity + \"] \" + msg);\n            }\n        }\n    };\n\n    var numArrayToHexArray = function(numArray) {\n        var hexArray = [];\n        for (var j = 0; j < numArray.length; j++) {\n            hexArray.push(numArray[j].toString(16));\n        }\n        return hexArray;\n    };\n\n    /**\n     * State of CEA-608 pen or character\n     * @constructor\n     */\n    var PenState = function(foreground, underline, italics, background, flash) {\n        this.foreground = foreground || \"white\";\n        this.underline = underline || false;\n        this.italics = italics || false;\n        this.background = background || \"black\";\n        this.flash = flash || false;\n    };\n\n    PenState.prototype = {\n        \n        reset : function() {\n            this.foreground = \"white\";\n            this.underline = false;\n            this.italics = false;\n            this.background = \"black\";\n            this.flash = false;\n        },\n        \n        setStyles : function(styles) {\n            var attribs = [\"foreground\", \"underline\", \"italics\", \"background\", \"flash\"];\n            for (var i = 0 ; i < attribs.length; i++) {\n                var style = attribs[i];\n                if (styles.hasOwnProperty(style)) {\n                    this[style] = styles[style];\n                }\n            }\n        },\n        \n        isDefault : function() {\n            return (this.foreground === \"white\" && !this.underline && !this.italics && \n                    this.background === \"black\" && !this.flash);\n        },\n\n        equals : function(other) {\n            return ( (this.foreground === other.foreground) && \n                     (this.underline === other.underline) &&\n                     (this.italics === other.italics) &&\n                     (this.background === other.background) &&\n                     (this.flash === other.flash) );\n        },\n\n        copy : function(newPenState) {\n            this.foreground = newPenState.foreground;\n            this.underline = newPenState.underline;\n            this.italics = newPenState.italics;\n            this.background = newPenState.background;\n            this.flash = newPenState.flash;\n        },\n        \n        toString: function() {\n            return (\"color=\" + this.foreground + \", underline=\" + this.underline + \", italics=\" + this.italics +\n                \", background=\" + this.background + \", flash=\" + this.flash);\n        }\n    };\n\n    /**\n     * Unicode character with styling and background.\n     * @constructor\n     */\n    var StyledUnicodeChar = function(uchar, foreground, underline, italics, background, flash) {\n        this.uchar = uchar || ' '; // unicode character\n        this.penState = new PenState(foreground, underline,italics, background, flash);\n    };\n\n    StyledUnicodeChar.prototype = {\n        \n        reset: function() {\n            this.uchar = ' ';\n            this.penState.reset();\n        },\n        \n        setChar: function(uchar, newPenState) {\n            this.uchar = uchar;\n            this.penState.copy(newPenState);\n        },\n        \n        setPenState: function(newPenState) {\n            this.penState.copy(newPenState);\n        },\n        \n        equals: function(other) {\n            return this.uchar === other.uchar && this.penState.equals(other.penState);\n        },\n        \n        copy: function(newChar) {\n            this.uchar = newChar.uchar;\n            this.penState.copy(newChar.penState);\n        },\n        \n        isEmpty : function() {\n            return this.uchar === ' ' && this.penState.isDefault();\n        }\n    };\n\n    /**\n     * CEA-608 row consisting of NR_COLS instances of StyledUnicodeChar.\n     * @constructor\n     */\n    var Row = function() {\n        this.chars = [];\n        for (var i = 0 ; i < NR_COLS ; i++) {\n            this.chars.push(new StyledUnicodeChar());\n        }\n        this.pos = 0;\n        this.currPenState = new PenState();\n    };\n\n    Row.prototype = {\n        \n        equals: function(other) {\n            var equal = true;\n            for (var i = 0 ; i < NR_COLS; i ++) {\n                if (!this.chars[i].equals(other.chars[i])) {\n                    equal = false;\n                    break;\n                }\n            }\n            return equal;\n        },\n        \n        copy: function(other) {\n            for (var i = 0 ; i < NR_COLS; i ++) {\n                this.chars[i].copy(other.chars[i]);\n            }\n        },\n        \n        isEmpty : function() {\n            var empty = true;\n            for (var i = 0 ; i < NR_COLS; i ++) {\n                if (!this.chars[i].isEmpty()) {\n                    empty = false;\n                    break;\n                }\n            }\n            return empty;\n        },\n\n        /**\n         *  Set the cursor to a valid column.\n         */\n        setCursor : function(absPos) {\n            if (this.pos !== absPos) {\n                this.pos = absPos;\n            }\n            if (this.pos < 0) {\n                logger.log(\"ERROR\", \"Negative cursor position \" + this.pos);\n                this.pos = 0;\n            } else if (this.pos > NR_COLS) {\n                logger.log(\"ERROR\", \"Too large cursor position \" + this.pos);\n                this.pos = NR_COLS;\n            }\n        },\n\n        /** \n         * Move the cursor relative to current position.\n         */\n        moveCursor : function(relPos) {\n            var newPos = this.pos + relPos;\n            if (relPos > 1) {\n                for (var i = this.pos+1; i < newPos+1 ; i++) {\n                    this.chars[i].setPenState(this.currPenState);\n                }\n            }\n            this.setCursor(newPos);\n        },\n\n        /**\n         * Backspace, move one step back and clear character.\n         */\n        backSpace : function () {\n            this.moveCursor(-1);\n            this.chars[this.pos].setChar(' ', this.currPenState);\n        },\n\n        insertChar: function(byte) {\n            if (byte >= 0x90) { //Extended char\n                this.backSpace();\n            }\n            var char = getCharForByte(byte);\n            if (this.pos >= NR_COLS) {\n                logger.log(\"ERROR\", \"Cannot insert \" + byte.toString(16) +  \n                            \" (\" + char + \") at position \" + this.pos + \". Skipping it!\");\n                return;\n            }\n            this.chars[this.pos].setChar(char, this.currPenState);\n            this.moveCursor(1);\n        },\n\n        clearFromPos : function(startPos) {\n            var i;\n            for (i = startPos ; i < NR_COLS ; i++) {\n                this.chars[i].reset();\n            }\n        },\n\n        clear : function() {\n            this.clearFromPos(0);\n            this.pos = 0;\n            this.currPenState.reset();\n        },\n\n        clearToEndOfRow : function() {\n            this.clearFromPos(this.pos);\n        },\n\n        getTextString: function() {\n            var chars = [];\n            var empty = true;\n            for (var i = 0 ; i < NR_COLS ; i++) {\n                var char = this.chars[i].uchar;\n                if (char !== \" \") {\n                    empty = false;\n                }\n                chars.push(char);\n            }\n            if (empty) {\n                return \"\";\n            } else {\n                return chars.join(\"\");\n            }\n        },\n\n        setPenStyles: function(styles) {\n            this.currPenState.setStyles(styles);\n            var currChar = this.chars[this.pos];\n            currChar.setPenState(this.currPenState);\n        }\n    };\n\n    /**\n     * Keep a CEA-608 screen of 32x15 styled characters\n     * @constructor\n    */\n    var CaptionScreen = function() {\n\n        this.rows = [];\n        for (var i = 0 ; i <  NR_ROWS; i++) {\n            this.rows.push(new Row()); // Note that we use zero-based numbering (0-14)\n        }\n        this.currRow = NR_ROWS - 1;\n        this.nrRollUpRows = null;\n        this.reset();\n    };\n\n    CaptionScreen.prototype = {\n\n        reset : function() {\n            for (var i = 0 ; i < NR_ROWS ; i++) {\n                this.rows[i].clear();\n            }\n            this.currRow = NR_ROWS - 1;\n        },\n\n        equals : function(other) {\n            var equal = true;\n            for (var i = 0 ; i < NR_ROWS ; i++) {\n                if (!this.rows[i].equals(other.rows[i])) {\n                    equal = false;\n                    break;\n                }\n            }\n            return equal;\n        },\n\n        copy : function(other) {\n            for (var i = 0 ; i < NR_ROWS ; i++) {\n                this.rows[i].copy(other.rows[i]);\n            }\n        },\n\n        isEmpty : function() {\n            var empty = true;\n            for (var i = 0 ; i < NR_ROWS ; i++) {\n                if (!this.rows[i].isEmpty()) {\n                    empty = false;\n                    break;\n                }\n            }\n            return empty;\n        },\n\n        backSpace : function() {\n            var row = this.rows[this.currRow]; \n            row.backSpace();\n        },\n\n        clearToEndOfRow : function() {\n            var row = this.rows[this.currRow];\n            row.clearToEndOfRow();\n        },\n\n        /**\n         * Insert a character (without styling) in the current row.\n         */\n        insertChar : function(char) {\n            var row = this.rows[this.currRow];\n            row.insertChar(char);\n        },\n\n        setPen : function(styles) {\n            var row = this.rows[this.currRow];\n            row.setPenStyles(styles);\n        },\n\n        moveCursor : function(relPos) {\n            var row = this.rows[this.currRow];\n            row.moveCursor(relPos); \n        },\n\n        setCursor : function(absPos) {\n            logger.log(\"INFO\", \"setCursor: \" + absPos);\n            var row = this.rows[this.currRow];\n            row.setCursor(absPos);\n        },\n\n        setPAC : function(pacData) {\n            logger.log(\"INFO\", \"pacData = \" + JSON.stringify(pacData));\n            var newRow = pacData.row - 1;\n            if (this.nrRollUpRows  && newRow < this.nrRollUpRows - 1) {\n                    newRow = this.nrRollUpRows-1;\n            }\n            this.currRow = newRow;\n            var row = this.rows[this.currRow];\n            if (pacData.indent !== null) {\n                var indent = pacData.indent;\n                var prevPos = Math.max(indent-1, 0);\n                row.setCursor(pacData.indent);\n                pacData.color = row.chars[prevPos].penState.foreground;\n            }\n            var styles = {foreground : pacData.color, underline : pacData.underline, italics : pacData.italics, background : 'black', flash : false};\n            this.setPen(styles);\n        },\n\n        /**\n         * Set background/extra foreground, but first do back_space, and then insert space (backwards compatibility).\n         */\n        setBkgData : function(bkgData) {\n\n            logger.log(\"INFO\", \"bkgData = \" + JSON.stringify(bkgData));\n            this.backSpace();\n            this.setPen(bkgData);\n            this.insertChar(0x20); //Space\n        },\n\n        setRollUpRows : function(nrRows) {\n            this.nrRollUpRows = nrRows;\n        },\n\n        rollUp : function() {\n            if (this.nrRollUpRows === null) {\n                logger.log(\"DEBUG\", \"roll_up but nrRollUpRows not set yet\");\n                return; //Not properly setup\n            }\n            logger.log(\"TEXT\", this.getDisplayText());\n            var topRowIndex = this.currRow + 1 - this.nrRollUpRows;\n            var topRow = this.rows.splice(topRowIndex, 1)[0];\n            topRow.clear();\n            this.rows.splice(this.currRow, 0, topRow);\n            logger.log(\"INFO\", \"Rolling up\");\n            //logger.log(\"TEXT\", this.get_display_text())\n        },\n\n       /**\n        * Get all non-empty rows with as unicode text. \n        */        \n        getDisplayText : function(asOneRow) {\n            asOneRow = asOneRow || false;\n            var displayText = [];\n            var text = \"\";\n            var rowNr = -1;\n            for (var i = 0 ; i < NR_ROWS ; i++) {\n                var rowText = this.rows[i].getTextString();\n                if (rowText) {\n                    rowNr = i+1;\n                    if (asOneRow) {\n                        displayText.push(\"Row \" + rowNr + ': \"' + rowText + '\"');\n                    } else {\n                        displayText.push(rowText.trim());\n                    }\n                }\n            }\n            if (displayText.length > 0) {\n                if (asOneRow) {\n                    text = \"[\" + displayText.join(\" | \") + \"]\";\n                } else {\n                    text = displayText.join(\"\\n\");\n                }\n            }\n            return text;\n        },\n\n        getTextAndFormat : function() {\n            return this.rows;\n        }\n    };\n\n    /**\n     * Handle a CEA-608 channel and send decoded data to outputFilter\n     * @constructor\n     * @param {Number} channelNumber (1 or 2)\n     * @param {CueHandler} outputFilter Output from channel1 newCue(startTime, endTime, captionScreen)\n    */\n    var Cea608Channel = function(channelNumber, outputFilter) {\n\n        this.chNr = channelNumber;\n        this.outputFilter = outputFilter;\n        this.mode = null;\n        this.verbose = 0;\n        this.displayedMemory = new CaptionScreen();\n        this.nonDisplayedMemory = new CaptionScreen();\n        this.lastOutputScreen = new CaptionScreen();\n        this.currRollUpRow = this.displayedMemory.rows[NR_ROWS-1];\n        this.writeScreen = this.displayedMemory;\n        this.mode = null;\n        this.cueStartTime = null; // Keeps track of where a cue started.\n    };\n\n    Cea608Channel.prototype = {\n        \n        modes : [\"MODE_ROLL-UP\", \"MODE_POP-ON\", \"MODE_PAINT-ON\", \"MODE_TEXT\"],\n        \n        reset : function() {\n            this.mode = null;\n            this.displayedMemory.reset();\n            this.nonDisplayedMemory.reset();\n            this.lastOutputScreen.reset();\n            this.currRollUpRow = this.displayedMemory.rows[NR_ROWS-1];\n            this.writeScreen = this.displayedMemory;\n            this.mode = null;\n            this.cueStartTime = null;\n            this.lastCueEndTime = null;\n        },\n\n        getHandler : function() {\n            return this.outputFilter;\n        },\n\n        setHandler : function(newHandler) {\n            this.outputFilter = newHandler;\n        },\n\n        setPAC : function(pacData) {\n            this.writeScreen.setPAC(pacData);\n        },\n\n        setBkgData : function(bkgData) {\n            this.writeScreen.setBkgData(bkgData);\n        },\n\n        setMode : function(newMode) {\n            if (newMode === this.mode) {\n                return;\n            }\n            this.mode = newMode;\n            logger.log(\"INFO\", \"MODE=\" + newMode);\n            if (this.mode == \"MODE_POP-ON\") {\n                this.writeScreen = this.nonDisplayedMemory;\n            } else {\n                this.writeScreen = this.displayedMemory;\n                this.writeScreen.reset();\n            }\n            if (this.mode !== \"MODE_ROLL-UP\") {\n                this.displayedMemory.nrRollUpRows = null;\n                this.nonDisplayedMemory.nrRollUpRows = null;\n            }\n            this.mode = newMode;\n        },\n\n        insertChars : function(chars) {\n            for (var i = 0 ; i < chars.length ; i++) {\n                this.writeScreen.insertChar(chars[i]);\n            }\n            var screen = this.writeScreen === this.displayedMemory ? \"DISP\" : \"NON_DISP\";\n            logger.log(\"INFO\", screen + \": \" + this.writeScreen.getDisplayText(true));\n            if (this.mode === \"MODE_PAINT-ON\" || this.mode === \"MODE_ROLL-UP\") {\n                logger.log(\"TEXT\", \"DISPLAYED: \" + this.displayedMemory.getDisplayText(true));\n                this.outputDataUpdate();\n            }\n        },\n\n        cc_RCL: function() { // Resume Caption Loading (switch mode to Pop On)\n            logger.log(\"INFO\", \"RCL - Resume Caption Loading\");\n            this.setMode(\"MODE_POP-ON\");\n        },\n        cc_BS: function() { // BackSpace\n            logger.log(\"INFO\", \"BS - BackSpace\");\n            if (this.mode === \"MODE_TEXT\") {\n                return;\n            }\n            this.writeScreen.backSpace();\n            if (this.writeScreen === this.displayedMemory) {\n                this.outputDataUpdate();\n            }\n        },\n        cc_AOF : function() { // Reserved (formerly Alarm Off)\n            return;\n        },\n        cc_AON: function() { // Reserved (formerly Alarm On)\n            return;\n        },\n        cc_DER: function() { // Delete to End of Row\n            logger.log(\"INFO\", \"DER- Delete to End of Row\");\n            this.writeScreen.clearToEndOfRow();\n            this.outputDataUpdate();\n        },\n        cc_RU: function(nrRows) { //Roll-Up Captions-2,3,or 4 Rows\n            logger.log(\"INFO\", \"RU(\" + nrRows +\") - Roll Up\");\n            this.writeScreen = this.displayedMemory;\n            this.setMode(\"MODE_ROLL-UP\");\n            this.writeScreen.setRollUpRows(nrRows);\n        },\n        cc_FON: function() { //Flash On\n            logger.log(\"INFO\", \"FON - Flash On\");\n            this.writeScreen.setPen({flash : true});\n        },\n        cc_RDC: function() { // Resume Direct Captioning (switch mode to PaintOn)\n            logger.log(\"INFO\", \"RDC - Resume Direct Captioning\");\n            this.setMode(\"MODE_PAINT-ON\");\n        },\n        cc_TR: function() { // Text Restart in text mode (not supported, however)\n            logger.log(\"INFO\", \"TR\");\n            this.setMode(\"MODE_TEXT\");\n        },\n        cc_RTD: function() { // Resume Text Display in Text mode (not supported, however)\n            logger.log(\"INFO\", \"RTD\");\n            this.setMode(\"MODE_TEXT\");\n        },\n        cc_EDM: function() { // Erase Displayed Memory\n            logger.log(\"INFO\", \"EDM - Erase Displayed Memory\");\n            this.displayedMemory.reset();\n            this.outputDataUpdate();\n        },\n        cc_CR: function() { // Carriage Return\n            logger.log(\"CR - Carriage Return\");\n            this.writeScreen.rollUp();\n            this.outputDataUpdate();\n        },\n        cc_ENM: function() { //Erase Non-Displayed Memory\n            logger.log(\"INFO\", \"ENM - Erase Non-displayed Memory\");\n            this.nonDisplayedMemory.reset();\n        },\n        cc_EOC: function() { //End of Caption (Flip Memories)\n            logger.log(\"INFO\", \"EOC - End Of Caption\");\n            if (this.mode === \"MODE_POP-ON\") {\n                var tmp = this.displayedMemory;\n                this.displayedMemory = this.nonDisplayedMemory;\n                this.nonDisplayedMemory = tmp;\n                this.writeScreen = this.nonDisplayedMemory;\n                logger.log(\"TEXT\", \"DISP: \" + this.displayedMemory.getDisplayText());\n            }\n            this.outputDataUpdate();\n        },\n        cc_TO: function(nrCols) { // Tab Offset 1,2, or 3 columns\n            logger.log(\"INFO\", \"TO(\" + nrCols + \") - Tab Offset\");\n            this.writeScreen.moveCursor(nrCols);\n        },\n        cc_MIDROW: function(secondByte) { // Parse MIDROW command\n            var styles = {flash : false};\n            styles.underline = secondByte % 2 === 1;\n            styles.italics = secondByte >= 0x2e;\n            if (!styles.italics) {\n                var colorIndex = Math.floor(secondByte/2) - 0x10;\n                var colors = [\"white\", \"green\", \"blue\", \"cyan\", \"red\", \"yellow\", \"magenta\"];\n                styles.foreground = colors[colorIndex];\n            } else {\n                styles.foreground = \"white\";\n            }\n            logger.log(\"INFO\", \"MIDROW: \" + JSON.stringify(styles));\n            this.writeScreen.setPen(styles);\n        },\n\n        outputDataUpdate: function() {\n            var t = logger.time;\n            if (t === null) {\n                return;\n            }\n            if (this.outputFilter) {\n                if (this.outputFilter.updateData) {\n                    this.outputFilter.updateData(t, this.displayedMemory);\n                }\n                if (this.cueStartTime === null && !this.displayedMemory.isEmpty()) { // Start of a new cue\n                    this.cueStartTime = t;\n                } else {\n                    if (!this.displayedMemory.equals(this.lastOutputScreen)) { \n                        if (this.outputFilter.newCue) {\n                            this.outputFilter.newCue(this.cueStartTime, t, this.lastOutputScreen);\n                        }\n                        this.cueStartTime = this.displayedMemory.isEmpty() ? null : t;\n                    }\n                }\n                this.lastOutputScreen.copy(this.displayedMemory);\n            }\n        },\n\n        cueSplitAtTime : function(t) {\n            if (this.outputFilter) {\n                if (!this.displayedMemory.isEmpty()) {\n                    if (this.outputFilter.newCue) {\n                        this.outputFilter.newCue(this.cueStartTime, t, this.displayedMemory);\n                    }\n                    this.cueStartTime = t;\n                }\n            }\n        }\n    };\n\n    /**\n     * Parse CEA-608 data and send decoded data to out1 and out2.\n     * @constructor\n     * @param {Number} field  CEA-608 field (1 or 2)\n     * @param {CueHandler} out1 Output from channel1 newCue(startTime, endTime, captionScreen)\n     * @param {CueHandler} out2 Output from channel2 newCue(startTime, endTime, captionScreen)\n     */\n    var Cea608Parser = function(field, out1, out2) {\n        this.field = field || 1;\n        this.outputs = [out1, out2];\n        this.channels = [new Cea608Channel(1, out1), new Cea608Channel(2, out2)];\n        this.currChNr = -1; // Will be 1 or 2\n        this.lastCmdA = null; // First byte of last command\n        this.lastCmdB = null; // Second byte of last command\n        this.bufferedData = [];\n        this.startTime = null;\n        this.lastTime = null;\n        this.dataCounters = {'padding' : 0, 'char' : 0, 'cmd' : 0, 'other' : 0};\n    };\n\n    Cea608Parser.prototype = {\n        \n        getHandler : function(index) {\n            return this.channels[index].getHandler();\n        },\n        \n        setHandler : function(index, newHandler) {\n            this.channels[index].setHandler(newHandler);\n        },\n\n        /**\n         * Add data for time t in forms of list of bytes (unsigned ints). The bytes are treated as pairs.\n         */\n        addData : function(t, byteList) {\n            var cmdFound, a, b, \n            charsFound = false;\n            \n            this.lastTime = t;\n            logger.setTime(t);\n\n            for (var i = 0 ; i < byteList.length ; i+=2) {\n                a = byteList[i] & 0x7f;\n                b = byteList[i+1] & 0x7f;\n                if (a === 0 && b === 0) {\n                    this.dataCounters.padding += 2;\n                    continue;\n                } else {\n                    logger.log(\"DATA\", \"[\" + numArrayToHexArray([byteList[i], byteList[i+1]]) +\"] -> (\" + numArrayToHexArray([a, b]) + \")\");\n                }\n                cmdFound = this.parseCmd(a, b);\n                if (!cmdFound) {\n                    cmdFound = this.parseMidrow(a, b);\n                }\n                if (!cmdFound) {\n                    cmdFound = this.parsePAC(a, b);\n                }\n                if (!cmdFound) {\n                    cmdFound = this.parseBackgroundAttributes(a, b);\n                }\n                if (!cmdFound) {\n                    charsFound = this.parseChars(a, b);\n                    if (charsFound) {\n                        if (this.currChNr && this.currChNr >=0) {\n                            var channel = this.channels[this.currChNr-1];\n                            channel.insertChars(charsFound);\n                        } else {\n                            logger.log(\"WARNING\", \"No channel found yet. TEXT-MODE?\");\n                        }\n                    }\n                }\n                if (cmdFound) {\n                    this.dataCounters.cmd += 2;\n                } else if (charsFound) {\n                    this.dataCounters.char += 2;\n                } else {\n                    this.dataCounters.other += 2;\n                    logger.log(\"WARNING\", \"Couldn't parse cleaned data \" + numArrayToHexArray([a, b]) +\n                                \" orig: \" + numArrayToHexArray([byteList[i], byteList[i+1]]));\n                }\n            }\n        },\n\n        /**\n         * Parse Command.\n         * @returns {Boolean} Tells if a command was found\n         */\n        parseCmd: function(a, b) {\n            var chNr = null;\n\n            var cond1 = (a === 0x14 || a === 0x1C) && (0x20 <= b && b <= 0x2F);\n            var cond2 = (a === 0x17 || a === 0x1F) && (0x21 <= b && b <= 0x23);\n            if (!(cond1 || cond2)) {\n                return false;\n            }\n                 \n            if (a === this.lastCmdA && b === this.lastCmdB) {\n                this.lastCmdA = null;\n                this.lastCmdB = null; // Repeated commands are dropped (once)\n                logger.log(\"DEBUG\", \"Repeated command (\" + numArrayToHexArray([a, b]) + \") is dropped\");\n                return true;\n            }\n\n            if (a === 0x14 || a === 0x17) {\n                chNr = 1;\n            } else {\n                chNr = 2; // (a === 0x1C || a=== 0x1f)\n            }\n\n            var channel = this.channels[chNr - 1];\n\n            if (a === 0x14 || a === 0x1C) {\n                if (b === 0x20) {\n                    channel.cc_RCL();\n                } else if (b === 0x21) {\n                    channel.cc_BS();\n                } else if (b === 0x22) {\n                    channel.cc_AOF();\n                } else if (b === 0x23) {\n                    channel.cc_AON();\n                } else if (b === 0x24) {\n                    channel.cc_DER();\n                } else if (b === 0x25) {\n                    channel.cc_RU(2);\n                } else if (b === 0x26) {\n                    channel.cc_RU(3);\n                } else if (b === 0x27) {\n                    channel.cc_RU(4);\n                } else if (b === 0x28) {\n                    channel.cc_FON();\n                } else if (b === 0x29) {\n                    channel.cc_RDC();\n                } else if (b === 0x2A) {\n                    channel.cc_TR();\n                } else if (b === 0x2B) {\n                    channel.cc_RTD();\n                } else if (b === 0x2C) {\n                    channel.cc_EDM();\n                } else if (b === 0x2D) {\n                    channel.cc_CR();\n                } else if (b === 0x2E) {\n                    channel.cc_ENM();\n                } else if (b === 0x2F) {\n                    channel.cc_EOC();\n                }\n            } else { //a == 0x17 || a == 0x1F\n                channel.cc_TO(b - 0x20);\n            }\n            this.lastCmdA = a;\n            this.lastCmdB = b;\n            this.currChNr = chNr;\n            return true;\n        },\n\n        /**\n         * Parse midrow styling command\n         * @returns {Boolean}\n         */\n        parseMidrow : function(a, b) {\n            var chNr = null;\n                \n            if ( ((a === 0x11) || (a === 0x19)) && 0x20 <= b && b <= 0x2f) {\n                if (a === 0x11) {\n                    chNr = 1;\n                } else  {\n                    chNr = 2;\n                }\n                if (chNr !== this.currChNr) {\n                    logger.log(\"ERROR\", \"Mismatch channel in midrow parsing\");\n                    return false;\n                }\n                var channel = this.channels[chNr-1];\n                channel.cc_MIDROW(b);\n                logger.log(\"DEBUG\", \"MIDROW (\" + numArrayToHexArray([a, b]) + \")\");\n                return true;\n            }\n            return false;\n        },\n        /**\n         * Parse Preable Access Codes (Table 53).\n         * @returns {Boolean} Tells if PAC found\n         */\n        parsePAC : function(a, b) {\n\n           var chNr = null;\n           var row = null;\n            \n            var case1 = ((0x11 <= a  && a <= 0x17) || (0x19 <= a && a <= 0x1F)) && (0x40 <= b && b <= 0x7F);\n            var case2 = (a === 0x10 || a === 0x18) && (0x40 <= b && b <= 0x5F);\n            if (! (case1 || case2)) {\n                return false;\n            }\n\n            if (a === this.lastCmdA && b === this.lastCmdB) {\n                this.lastCmdA = null;\n                this.lastCmdB = null;\n                return true; // Repeated commands are dropped (once)\n            }\n\n            chNr = (a <= 0x17) ? 1 : 2;\n\n            if (0x40 <= b && b <= 0x5F) {\n                row = (chNr === 1) ? rowsLowCh1[a] : rowsLowCh2[a];\n            } else { // 0x60 <= b <= 0x7F\n                row = (chNr === 1) ? rowsHighCh1[a] : rowsHighCh2[a];\n            }\n            var pacData = this.interpretPAC(row, b);\n            var channel = this.channels[chNr-1];\n            channel.setPAC(pacData);\n            this.lastCmdA = a;\n            this.lastCmdB = b;\n            this.currChNr = chNr;\n            return true;\n        },\n\n        /**\n         * Interpret the second byte of the pac, and return the information.\n         * @returns {Object} pacData with style parameters.\n         */\n        interpretPAC : function (row, byte) {\n            var pacIndex = byte;\n            var pacData = {color : null, italics : false, indent : null, underline : false, row : row};\n            \n            if (byte > 0x5F) {\n                pacIndex = byte - 0x60;\n            } else {\n                pacIndex = byte - 0x40;\n            }\n            pacData.underline = (pacIndex & 1) === 1;\n            if (pacIndex <= 0xd) {\n                pacData.color = ['white', 'green', 'blue', 'cyan', 'red', 'yellow', 'magenta', 'white'][Math.floor(pacIndex/2)];\n            } else if (pacIndex <= 0xf) {\n                pacData.italics = true;\n                pacData.color = 'white';\n            } else {\n                pacData.indent = (Math.floor((pacIndex-0x10)/2))*4;\n            }\n            return pacData; // Note that row has zero offset. The spec uses 1.\n        },\n\n        /**\n         * Parse characters.\n         * @returns An array with 1 to 2 codes corresponding to chars, if found. null otherwise.\n         */\n        parseChars : function(a, b) {\n\n           var  channelNr = null,\n                charCodes = null,\n                charCode1 = null,\n                charCode2 = null;\n\n            if (a >= 0x19) {\n                channelNr = 2;\n                charCode1 = a - 8;\n            } else {\n                channelNr = 1;\n                charCode1 = a;\n            }\n            if (0x11 <= charCode1 && charCode1 <= 0x13) {\n                // Special character\n                var oneCode = b;\n                if (charCode1 === 0x11) {\n                    oneCode = b + 0x50;\n                } else if (charCode1 === 0x12) {\n                    oneCode = b + 0x70;\n                } else {\n                    oneCode = b + 0x90;\n                }\n                logger.log(\"INFO\", \"Special char '\" + getCharForByte(oneCode) + \"' in channel \" + channelNr);\n                charCodes = [oneCode];\n            } else if (0x20 <= a && a <= 0x7f) {\n                charCodes = (b === 0) ? [a] : [a, b];\n            }\n            if (charCodes) {\n                var hexCodes = numArrayToHexArray(charCodes);\n                logger.log(\"DEBUG\", \"Char codes =  \" + hexCodes.join(\",\"));\n                this.lastCmdA = null;\n                this.lastCmdB = null;\n            }\n            return charCodes;\n        },\n        \n        /**\n        * Parse extended background attributes as well as new foreground color black.\n        * @returns{Boolean} Tells if background attributes are found\n        */\n        parseBackgroundAttributes : function(a, b) {\n           var  bkgData,\n                index,\n                chNr,\n                channel;\n\n            var case1 = (a === 0x10 || a === 0x18) && (0x20 <= b && b <= 0x2f);\n            var case2 = (a === 0x17 || a === 0x1f) && (0x2d <=b && b <= 0x2f);\n            if (!(case1 || case2)) {\n                return false;\n            }\n            bkgData = {};\n            if (a  === 0x10 || a === 0x18) {\n                index = Math.floor((b-0x20)/2);\n                bkgData.background = backgroundColors[index];\n                if (b % 2 === 1) {\n                    bkgData.background = bkgData.background + \"_semi\";\n                }\n            } else if (b === 0x2d) {\n                bkgData.background = \"transparent\";\n            } else {\n                bkgData.foreground = \"black\";\n                if (b === 0x2f) {\n                    bkgData.underline = true;\n                }\n            }\n            chNr = (a < 0x18) ? 1 : 2;\n            channel = this.channels[chNr-1];\n            channel.setBkgData(bkgData);\n            this.lastCmdA = null;\n            this.lastCmdB = null;\n            return true;\n        },\n\n        /**\n         * Reset state of parser and its channels.\n         */\n        reset : function() {\n            for (var i=0 ; i < this.channels.length ; i++) {\n                if (this.channels[i]) {\n                    this.channels[i].reset();\n                }\n            }\n            this.lastCmdA = null;\n            this.lastCmdB = null;\n        },\n\n        /**\n         * Trigger the generation of a cue, and the start of a new one if displayScreens are not empty.\n         */\n        cueSplitAtTime : function(t) {\n            for (var i=0 ; i < this.channels.length ; i++) {\n                if (this.channels[i]) {\n                    this.channels[i].cueSplitAtTime(t);\n                }\n            }\n        },\n    };\n\n    /**\n     * Find ranges corresponding to SEA CEA-608 NALUS in sizeprepended NALU array.\n     * @param {raw} dataView of binary data\n     * @param {startPos} start position in raw\n     * @param {size} total size of data in raw to consider\n     * @returns \n     */\n    var findCea608Nalus = function(raw, startPos, size) {\n        var nalSize = 0,\n            cursor = startPos,\n            nalType = 0,\n            cea608NaluRanges = [],\n            // Check SEI data according to ANSI-SCTE 128\n            isCEA608SEI = function (payloadType, payloadSize, raw, pos) {\n                if (payloadType !== 4 || payloadSize < 8) {\n                    return null;\n                }\n                var countryCode = raw.getUint8(pos);\n                var providerCode = raw.getUint16(pos + 1);\n                var userIdentifier = raw.getUint32(pos + 3);\n                var userDataTypeCode = raw.getUint8(pos + 7);\n                return countryCode == 0xB5 && providerCode == 0x31 && userIdentifier == 0x47413934 && userDataTypeCode == 0x3;\n            };\n        while (cursor < startPos + size) {\n            nalSize = raw.getUint32(cursor);\n            nalType = raw.getUint8(cursor + 4) & 0x1F;\n            //console.log(time + \"  NAL \" + nalType);\n            if (nalType === 6) {\n                // SEI NAL Unit. The NAL header is the first byte\n                //console.log(\"SEI NALU of size \" + nalSize + \" at time \" + time);\n                var pos = cursor + 5;\n                var payloadType = -1;\n                while (pos < cursor + 4 + nalSize - 1) { // The last byte should be rbsp_trailing_bits\n                    payloadType = 0;\n                    var b = 0xFF;\n                    while (b === 0xFF) {\n                        b = raw.getUint8(pos);\n                        payloadType += b;\n                        pos++;\n                    }\n                    var payloadSize = 0;\n                    b = 0xFF;\n                    while (b === 0xFF) {\n                        b = raw.getUint8(pos);\n                        payloadSize += b;\n                        pos++;\n                    }\n                    if (isCEA608SEI(payloadType, payloadSize, raw, pos)) {\n                        //console.log(\"CEA608 SEI \" + time + \" \" + payloadSize);\n                        cea608NaluRanges.push([pos, payloadSize]);\n                    }\n                    pos += payloadSize;\n                }\n            }\n            cursor += nalSize + 4;\n        }\n        return cea608NaluRanges;\n    };\n    \n    var extractCea608DataFromRange = function(raw, cea608Range) {\n        var pos = cea608Range[0];\n        var fieldData = [[], []];\n\n        pos += 8; // Skip the identifier up to userDataTypeCode\n        var ccCount = raw.getUint8(pos) & 0x1f;\n        pos += 2; // Advance 1 and skip reserved byte\n          \n        for (var i = 0; i < ccCount; i++) {\n            var byte = raw.getUint8(pos);\n            var ccValid = byte & 0x4;\n            var ccType = byte & 0x3;\n            pos++;\n            var ccData1 = raw.getUint8(pos); // Keep parity bit\n            pos++;\n            var ccData2 = raw.getUint8(pos); // Keep parity bit\n            pos++;\n            if (ccValid && ((ccData1 & 0x7f) + (ccData2 & 0x7f) !== 0)) { //Check validity and non-empty data\n                if (ccType === 0) {\n                    fieldData[0].push(ccData1);\n                    fieldData[0].push(ccData2);\n                } else if (ccType === 1) {\n                    fieldData[1].push(ccData1);\n                    fieldData[1].push(ccData2);\n                }\n            }\n        }\n        return fieldData;\n    };\n\n    exports.logger = logger;\n    exports.PenState = PenState;\n    exports.CaptionScreen = CaptionScreen;  \n    exports.Cea608Parser = Cea608Parser;\n    exports.findCea608Nalus = findCea608Nalus;\n    exports.extractCea608DataFromRange = extractCea608DataFromRange;\n\n}(typeof exports === 'undefined' ? this.cea608parser = {} : exports));\n"]}