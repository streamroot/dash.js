{"version":3,"sources":["../../../externals/objectiron.js"],"names":[],"mappings":"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","file":"objectiron.js","sourcesContent":["/*\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * author Digital Primates\n * copyright dash-if 2012\n */\n\n/*\n * var parent,\n *     child,\n *     properties = [\n                    {\n                        name: 'profiles',\n                        merge: false\n                    }\n                ];\n *\n * parent = {};\n * parent.name = \"ParentNode\";\n * parent.isRoor = false;\n * parent.isArray = false;\n * parent.children = [];\n * parent.properties = properties;\n *\n * child = {};\n * child.name = \"ChildNode\";\n * child.isRoor = false;\n * child.isArray = true;\n * child.children = null;\n * child.properties = properties;\n * parent.children.push(child);\n *\n */\n\nfunction ObjectIron(map) {\n\n    var lookup,\n        len,\n        i;\n\n    // create a list of top level items to search for\n    lookup = [];\n    for (i = 0, len = map.length; i < len; i += 1) {\n        if (map[i].isRoot) {\n            lookup.push(\"root\");\n        } else {\n            lookup.push(map[i].name);\n        }\n    }\n\n    var mergeValues = function (parentItem, childItem) {\n            var name,\n                parentValue,\n                childValue;\n\n            if (parentItem === null || childItem === null) {\n                return;\n            }\n\n            for (name in parentItem) {\n                if (parentItem.hasOwnProperty(name)) {\n                    if (!childItem.hasOwnProperty(name)) {\n                        childItem[name] = parentItem[name];\n                    }\n                }\n            }\n        },\n\n        mapProperties = function (properties, parent, child) {\n            var i,\n                len,\n                property,\n                parentValue,\n                childValue;\n\n            if (properties === null || properties.length === 0) {\n                return;\n            }\n\n            for (i = 0, len = properties.length; i < len; i += 1) {\n                property = properties[i];\n\n                if (parent.hasOwnProperty(property.name)) {\n                    if (child.hasOwnProperty(property.name)) {\n                        // check to see if we should merge\n                        if (property.merge) {\n                           parentValue = parent[property.name];\n                           childValue = child[property.name];\n\n                            // complex objects; merge properties\n                            if (typeof parentValue === 'object' && typeof childValue === 'object') {\n                                mergeValues(parentValue, childValue);\n                            }\n                            // simple objects; merge them together\n                            else {\n                                if (property.mergeFunction != null) {\n                                    child[property.name] = property.mergeFunction(parentValue, childValue);\n                                } else {\n                                    child[property.name] = parentValue + childValue;\n                                }\n                            }\n                        }\n                    } else {\n                        // just add the property\n                        child[property.name] = parent[property.name];\n                    }\n                }\n            }\n        },\n\n        mapItem = function (obj, node) {\n            var item = obj,\n                i,\n                len,\n                v,\n                len2,\n                array,\n                childItem,\n                childNode,\n                property;\n\n            if (item.children === null || item.children.length === 0) {\n                return;\n            }\n\n            for (i = 0, len = item.children.length; i < len; i += 1) {\n                childItem = item.children[i];\n\n                if (node.hasOwnProperty(childItem.name)) {\n                    if (childItem.isArray) {\n                        array = node[childItem.name + \"_asArray\"];\n                        for (v = 0, len2 = array.length; v < len2; v += 1) {\n                            childNode = array[v];\n                            mapProperties(item.properties, node, childNode);\n                            mapItem(childItem, childNode);\n                        }\n                    } else {\n                        childNode = node[childItem.name];\n                        mapProperties(item.properties, node, childNode);\n                        mapItem(childItem, childNode);\n                    }\n                }\n            }\n        },\n\n        performMapping = function (source) {\n            var i,\n                len,\n                pi,\n                pp,\n                item,\n                node,\n                array;\n\n            if (source === null) {\n                return source;\n            }\n\n            if (typeof source !== 'object') {\n                return source;\n            }\n\n            // first look to see if anything cares about the root node\n            for (i = 0, len = lookup.length; i < len; i += 1) {\n                if (lookup[i] === \"root\") {\n                    item = map[i];\n                    node = source;\n                    mapItem(item, node);\n                }\n            }\n\n            // iterate over the objects and look for any of the items we care about\n            for (pp in source) {\n                if (source.hasOwnProperty(pp) && pp != \"__children\") {\n                    pi = lookup.indexOf(pp);\n                    if (pi !== -1) {\n                        item = map[pi];\n\n                        if (item.isArray) {\n                            array = source[pp + \"_asArray\"];\n                            for (i = 0, len = array.length; i < len; i += 1) {\n                                node = array[i];\n                                mapItem(item, node);\n                            }\n                        } else {\n                            node = source[pp];\n                            mapItem(item, node);\n                        }\n                    }\n                    // now check this to see if he has any of the properties we care about\n                    performMapping(source[pp]);\n                }\n            }\n\n            return source;\n        };\n\n    return {\n        run: performMapping\n    };\n}\n\nexport default ObjectIron;\n"]}