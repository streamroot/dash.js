{"version":3,"sources":["../../../../../src/streaming/text/EmbeddedTextHtmlRender.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;gCA8ByB,yBAAyB;;;;AAElD,SAAS,sBAAsB,GAAG;;AAE9B,QAAI,SAAS,GAAG,CAAC,CAAC;AAClB,QAAI,QAAQ,YAAA,CAAC;;;AAGb,aAAS,WAAW,CAAC,KAAK,EAAE;AACxB,YAAI,IAAI,GAAG,EAAE,CAAC;;AAEd,aAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;AACnC,gBAAI,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;AAClB,gBAAI,IAAI,EAAE,CAAC,KAAK,CAAC;SACpB;;AAED,YAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC;AACpB,YAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAC,EAAE,CAAC,CAAC,MAAM,CAAC;AACxC,eAAO,CAAC,GAAG,EAAE,CAAC;KACjB;;AAED,aAAS,mBAAmB,CAAC,MAAM,EAAE;AACjC,eAAO,QAAQ,GAAI,MAAM,CAAC,CAAC,GAAG,KAAK,AAAC,GAAG,UAAU,GAAI,MAAM,CAAC,EAAE,GAAG,IAAI,AAAC,GAAG,YAAY,IAAI,GAAG,GAAI,MAAM,CAAC,CAAC,GAAG,KAAK,CAAC,AAAC,GAAG,aAAa,GAAI,IAAI,CAAC,GAAG,CAAC,AAAC,MAAM,CAAC,EAAE,GAAG,CAAC,GAAI,MAAM,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,IAAI,AAAC,GAAG,qFAAqF,CAAC;KAClR;;AAED,aAAS,SAAS,CAAC,KAAK,EAAE;AACtB,YAAI,KAAK,KAAK,KAAK,EAAE;AACjB,mBAAO,gBAAgB,CAAC;SAC3B,MAAM,IAAI,KAAK,KAAK,OAAO,EAAE;AAC1B,mBAAO,gBAAgB,CAAC;SAC3B,MAAM,IAAI,KAAK,KAAK,MAAM,EAAE;AACzB,mBAAO,gBAAgB,CAAC;SAC3B,MAAM,IAAI,KAAK,KAAK,MAAM,EAAE;AACzB,mBAAO,kBAAkB,CAAC;SAC7B,MAAM,IAAI,KAAK,KAAK,SAAS,EAAE;AAC5B,mBAAO,kBAAkB,CAAC;SAC7B,MAAM,IAAI,KAAK,KAAK,QAAQ,EAAE;AAC3B,mBAAO,kBAAkB,CAAC;SAC7B,MAAM,IAAI,KAAK,KAAK,OAAO,EAAE;AAC1B,mBAAO,oBAAoB,CAAC;SAC/B,MAAM,IAAI,KAAK,KAAK,OAAO,EAAE;AAC1B,mBAAO,cAAc,CAAC;SACzB;AACD,eAAO,KAAK,CAAC;KAChB;;AAED,aAAS,QAAQ,CAAC,YAAY,EAAE,KAAK,EAAE;AACnC,YAAI,QAAQ,GAAG,YAAY,CAAC,WAAW,GAAG,IAAI,CAAC;AAC/C,YAAI,KAAK,EAAE;AACP,mBAAO,aAAa,GAAG,QAAQ,GAAG,uEAAuE,IAAI,AAAC,KAAK,CAAC,UAAU,GAAI,SAAS,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,oBAAoB,CAAA,AAAC,GAAG,gBAAgB,IAAI,KAAK,CAAC,OAAO,GAAG,QAAQ,GAAG,QAAQ,CAAA,AAAC,GAAG,qBAAqB,IAAI,KAAK,CAAC,SAAS,GAAG,WAAW,GAAG,MAAM,CAAA,AAAC,GAAG,wCAAwC,IAAI,AAAC,KAAK,CAAC,UAAU,GAAI,SAAS,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,aAAa,CAAA,AAAC,GAAG,GAAG,CAAC;SAC7a,MAAM;AACH,mBAAO,aAAa,GAAG,QAAQ,GAAG,4QAA4Q,CAAC;SAClT;KACJ;;AAED,aAAS,KAAK,CAAC,CAAC,EAAE;AACd,YAAI,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;AACrC,eAAO,OAAO,CAAC;KAClB;AACD,aAAS,KAAK,CAAC,CAAC,EAAE;AACd,YAAI,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;AACrC,eAAO,OAAO,CAAC;KAClB;;AAGD,aAAS,4BAA4B,CAAC,YAAY,EAAE,SAAS,EAAE,OAAO,EAAE,aAAa,EAAE;;AAEnF,YAAI,UAAU,GAAG,IAAI,CAAC;AACtB,YAAI,cAAc,GAAG,IAAI,CAAC;AAC1B,YAAI,cAAc,GAAG,KAAK,CAAC;AAC3B,YAAI,cAAc,GAAG,CAAC,CAAC,CAAC;AACxB,YAAI,KAAK,GAAG,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;AAC1D,YAAI,YAAY,GAAG,0BAA0B,CAAC;AAC9C,YAAI,WAAW,GAAG,EAAG,CAAC;AACtB,YAAI,WAAW,GAAG,EAAG,CAAC;AACtB,YAAI,OAAO,GAAG,EAAE,CAAC;AACjB,YAAI,CAAC,YAAA;YAAE,CAAC,YAAA,CAAC;;AAET,aAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,EAAE,CAAC,EAAE;AACrB,gBAAI,GAAG,GAAG,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAChC,gBAAI,IAAI,GAAG,EAAE,CAAC;AACd,gBAAI,YAAY,GAAG,IAAI,CAAC;;AAExB,gBAAI,KAAK,KAAK,GAAG,CAAC,OAAO,EAAE,EAAE;;;;AAIzB,oBAAI,SAAS,GAAG,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;;;AAGvC,oBAAI,UAAU,KAAK,IAAI,EAAE;AACrB,8BAAU,GAAG,EAAE,CAAC,EAAE,SAAS,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAG,CAAC,GAAG,CAAC,AAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;iBAC5D;;;AAGD,oBAAI,AAAC,SAAS,KAAK,cAAc,IAAK,cAAc,EAAE;AAClD,8BAAU,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AACzB,yBAAK,GAAG,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;AACtD,8BAAU,CAAC,EAAE,GAAG,CAAC,CAAC;AAClB,8BAAU,CAAC,IAAI,GAAG,SAAS,GAAG,UAAU,CAAC,CAAC,GAAG,GAAG,GAAG,UAAU,CAAC,EAAE,GAAG,GAAG,GAAG,UAAU,CAAC,EAAE,CAAC;AACvF,wBAAI,KAAK,KAAK,WAAW,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;AACvD,+BAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AACzB,mCAAW,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC;qBAC7C,MAAM;AACH,sCAAc,GAAG,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;AAC9C,sCAAc,CAAC,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;qBACzC;;AAED,8BAAU,GAAG,EAAE,CAAC,EAAE,SAAS,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAG,CAAC,GAAG,CAAC,AAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;iBAC5D;;AAED,qBAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;AACvC,wBAAI,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;AACtB,wBAAI,YAAY,GAAG,EAAE,CAAC,QAAQ,CAAC;AAC/B,wBAAI,AAAC,YAAY,KAAK,IAAI,IAAM,CAAC,YAAY,CAAC,MAAM,CAAC,YAAY,CAAC,AAAC,EAAE;AACjE,4BAAI,IAAI,CAAC,IAAI,EAAE,CAAC,MAAM,GAAG,CAAC,EAAE;AACxB,iCAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,YAAY,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;AAC7D,gCAAI,GAAG,EAAE,CAAC;yBACb;;AAED,4BAAI,kBAAkB,GAAG,eAAe,GAAG,YAAY,CAAC,UAAU,GAAG,GAAG,GAAG,YAAY,CAAC,UAAU,CAAC;AACnG,4BAAI,YAAY,CAAC,SAAS,EAAE;AACxB,8CAAkB,IAAI,YAAY,CAAC;yBACtC;AACD,4BAAI,YAAY,CAAC,OAAO,EAAE;AACtB,8CAAkB,IAAI,UAAU,CAAC;yBACpC;;AAED,4BAAI,CAAC,WAAW,CAAC,cAAc,CAAC,kBAAkB,CAAC,EAAE;AACjD,uCAAW,CAAC,kBAAkB,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;yBAC9E;;AAED,oCAAY,GAAG,YAAY,CAAC;;AAE5B,oCAAY,GAAG,kBAAkB,CAAC;qBACrC;;AAED,wBAAI,IAAI,EAAE,CAAC,KAAK,CAAC;iBACpB;;AAED,oBAAI,IAAI,CAAC,IAAI,EAAE,CAAC,MAAM,GAAG,CAAC,EAAE;AACxB,yBAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,YAAY,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;iBAChE;;AAED,8BAAc,GAAG,IAAI,CAAC;AACtB,8BAAc,GAAG,SAAS,CAAC;aAC9B,MAAM;;AAEH,8BAAc,GAAG,KAAK,CAAC;AACvB,8BAAc,GAAG,CAAC,CAAC,CAAC;;AAEpB,oBAAI,UAAU,EAAE;AACZ,8BAAU,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AACzB,yBAAK,GAAG,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;AACtD,8BAAU,CAAC,EAAE,GAAG,CAAC,CAAC;AAClB,8BAAU,CAAC,IAAI,GAAG,SAAS,GAAG,UAAU,CAAC,CAAC,GAAG,GAAG,GAAG,UAAU,CAAC,EAAE,GAAG,GAAG,GAAG,UAAU,CAAC,EAAE,CAAC;AACvF,wBAAI,KAAK,KAAK,WAAW,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;AACvD,+BAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AACzB,mCAAW,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC;qBAC7C,MAAM;AACH,sCAAc,GAAG,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;AAC9C,sCAAc,CAAC,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;qBACzC;;AAED,8BAAU,GAAG,IAAI,CAAC;iBACrB;aAEJ;SACJ;;AAED,YAAI,UAAU,EAAE;AACZ,sBAAU,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AACzB,sBAAU,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC;AACtB,sBAAU,CAAC,IAAI,GAAG,SAAS,GAAG,UAAU,CAAC,CAAC,GAAG,GAAG,GAAG,UAAU,CAAC,EAAE,GAAG,GAAG,GAAG,UAAU,CAAC,EAAE,CAAC;AACvF,gBAAI,KAAK,KAAK,WAAW,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;AACvD,uBAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AACzB,2BAAW,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC;aAC7C,MAAM;AACH,8BAAc,GAAG,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;AAC9C,8BAAc,CAAC,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;aACzC;;AAED,sBAAU,GAAG,IAAI,CAAC;SACrB;;;;;AAKD,YAAI,aAAa,GAAG,EAAE,CAAC;;;AAGvB,aAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;AACjC,gBAAI,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;;AAExB,gBAAI,KAAK,GAAG,aAAa,GAAI,SAAS,EAAE,AAAC,CAAC;AAC1C,gBAAI,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AAC7C,oBAAQ,CAAC,EAAE,GAAG,KAAK,CAAC;AACpB,gBAAI,mBAAmB,GAAG,mBAAmB,CAAC,MAAM,CAAC,CAAC;AACtD,oBAAQ,CAAC,KAAK,CAAC,OAAO,GAAG,6FAA6F,GAAG,mBAAmB,CAAC;;AAE7I,gBAAI,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AAC5C,mBAAO,CAAC,SAAS,GAAG,qBAAqB,CAAC;AAC1C,mBAAO,CAAC,KAAK,CAAC,OAAO,GAAG,QAAQ,CAAC,YAAY,CAAC,CAAC;;AAE/C,gBAAI,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AAClD,yBAAa,CAAC,SAAS,GAAG,eAAe,CAAC;AAC1C,yBAAa,CAAC,KAAK,CAAC,OAAO,GAAG,uCAAuC,CAAC;;AAEtE,iBAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;AACtC,oBAAI,IAAI,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACvB,oBAAI,WAAW,GAAG,CAAC,CAAC;AACpB,qBAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;AACpC,wBAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;AACzB,wBAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;AACtB,4BAAI,AAAC,CAAC,KAAK,CAAC,IAAK,WAAW,IAAI,IAAI,CAAC,GAAG,EAAE;AACtC,gCAAI,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;AAC7C,qCAAS,CAAC,SAAS,GAAG,WAAW,CAAC;AAClC,yCAAa,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;yBACxC;AACD,4BAAI,OAAO,GAAG,KAAK,CAAC;AACpB,4BAAI,WAAW,KAAK,IAAI,CAAC,GAAG,EAAE;AAC1B,mCAAO,GAAG,IAAI,CAAC;yBAClB;AACD,mCAAW,GAAG,IAAI,CAAC,GAAG,CAAC;AACvB,4BAAI,SAAS,GAAG,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACvC,4BAAI,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AACjD,mCAAW,CAAC,SAAS,GAAG,cAAc,GAAG,IAAI,CAAC,IAAI,GAAG,kBAAkB,CAAC;AACxE,mCAAW,CAAC,KAAK,CAAC,OAAO,GAAG,QAAQ,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;AAC9D,4BAAI,AAAC,CAAC,KAAK,CAAC,IAAK,OAAO,EAAE;AACtB,gCAAI,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;AAC7B,2CAAW,CAAC,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;6BAC9C,MAAM;AACH,2CAAW,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC;6BACvC;yBACJ,MAAM;AACH,gCAAI,CAAC,KAAK,CAAC,EAAE;AACT,oCAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;;AAEvB,wCAAI,IAAI,CAAC,GAAG,KAAK,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;;AAEhC,mDAAW,CAAC,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;qCAC9C,MAAM;;AAEH,mDAAW,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;qCAC9C;iCACJ,MAAM;AACH,+CAAW,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;iCAC9C;6BACJ,MAAM;AACH,2CAAW,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;6BAC9C;yBACJ;AACD,qCAAa,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;qBAC1C;iBACJ;aACJ;;AAED,mBAAO,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;;AAEnC,oBAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;;AAE9B,gBAAI,QAAQ,GAAG,EAAE,WAAW,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,CAAC;AAC1C,iBAAK,CAAC,IAAI,WAAW,EAAE;AACnB,oBAAI,WAAW,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE;AAC/B,4BAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;iBAC3B;aACJ;;AAED,yBAAa,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,MAAM;AACb,qBAAK,EAAE,SAAS;AAChB,mBAAG,EAAE,OAAO;AACZ,8BAAc,EAAE,QAAQ;AACxB,qBAAK,EAAE,KAAK;AACZ,8BAAc,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;AACxB,4BAAY,EAAE,IAAI;AAClB,uBAAO,EAAE,OAAO;AAChB,wBAAQ,EAAE,MAAM,CAAC,IAAI;AACrB,2BAAW,EAAE,YAAY,CAAC,WAAW;AACrC,0BAAU,EAAE,YAAY,CAAC,UAAU;AACnC,wBAAQ,EAAE,QAAQ;AAClB,0BAAU,EAAE,EAAE;AACd,2BAAW,EAAE,EAAE;aACf,CAAC,CAAC;SACzB;AACD,eAAO,aAAa,CAAC;KACxB;;AAED,YAAQ,GAAG;AACP,oCAA4B,EAAE,4BAA4B;KAC7D,CAAC;AACF,WAAO,QAAQ,CAAC;CACnB;;AAED,sBAAsB,CAAC,qBAAqB,GAAG,wBAAwB,CAAC;qBACzD,8BAAa,mBAAmB,CAAC,sBAAsB,CAAC","file":"EmbeddedTextHtmlRender.js","sourcesContent":["/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\nimport FactoryMaker from '../../core/FactoryMaker';\n\nfunction EmbeddedTextHtmlRender() {\n\n    let captionId = 0;\n    let instance;\n\n    /* HTML Rendering functions */\n    function checkIndent(chars) {\n        var line = '';\n\n        for (var c = 0; c < chars.length; ++c) {\n            var uc = chars[c];\n            line += uc.uchar;\n        }\n\n        var l = line.length;\n        var ll = line.replace(/^\\s+/,'').length;\n        return l - ll;\n    }\n\n    function getRegionProperties(region) {\n        return 'left: ' + (region.x * 3.125) + '%; top: ' + (region.y1 * 6.66) + '%; width: ' + (100 - (region.x * 3.125)) + '%; height: ' + (Math.max((region.y2 - 1) - region.y1, 1) * 6.66) + '%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;';\n    }\n\n    function createRGB(color) {\n        if (color === 'red') {\n            return 'rgb(255, 0, 0)';\n        } else if (color === 'green') {\n            return 'rgb(0, 255, 0)';\n        } else if (color === 'blue') {\n            return 'rgb(0, 0, 255)';\n        } else if (color === 'cyan') {\n            return 'rgb(0, 255, 255)';\n        } else if (color === 'magenta') {\n            return 'rgb(255, 0, 255)';\n        } else if (color === 'yellow') {\n            return 'rgb(255, 255, 0)';\n        } else if (color === 'white') {\n            return 'rgb(255, 255, 255)';\n        } else if (color === 'black') {\n            return 'rgb(0, 0, 0)';\n        }\n        return color;\n    }\n\n    function getStyle(videoElement, style) {\n        var fontSize = videoElement.videoHeight / 15.0;\n        if (style) {\n            return 'font-size: ' + fontSize + 'px; font-family: Menlo, Consolas, \\'Cutive Mono\\', monospace; color: ' + ((style.foreground) ? createRGB(style.foreground) : 'rgb(255, 255, 255)') + '; font-style: ' + (style.italics ? 'italic' : 'normal') + '; text-decoration: ' + (style.underline ? 'underline' : 'none') + '; white-space: pre; background-color: ' + ((style.background) ? createRGB(style.background) : 'transparent') + ';';\n        } else {\n            return 'font-size: ' + fontSize + 'px; font-family: Menlo, Consolas, \\'Cutive Mono\\', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;';\n        }\n    }\n\n    function ltrim(s) {\n        var trimmed = s.replace(/^\\s+/g, '');\n        return trimmed;\n    }\n    function rtrim(s) {\n        var trimmed = s.replace(/\\s+$/g, '');\n        return trimmed;\n    }\n\n\n    function createHTMLCaptionsFromScreen(videoElement, startTime, endTime, captionScreen) {\n\n        let currRegion = null;\n        let existingRegion = null;\n        let lastRowHasText = false;\n        let lastRowIndentL = -1;\n        let currP = { start: startTime, end: endTime, spans: [] };\n        let currentStyle = 'style_cea608_white_black';\n        let seenRegions = { };\n        let styleStates = { };\n        let regions = [];\n        let r, s;\n\n        for (r = 0; r < 15; ++r) {\n            let row = captionScreen.rows[r];\n            let line = '';\n            let prevPenState = null;\n\n            if (false === row.isEmpty()) {\n                /* Row is not empty */\n\n                /* Get indentation of this row */\n                let rowIndent = checkIndent(row.chars);\n\n                /* Create a new region is there is none */\n                if (currRegion === null) {\n                    currRegion = { x: rowIndent, y1: r, y2: (r + 1), p: [] };\n                }\n\n                /* Check if indentation has changed and we had text of last row */\n                if ((rowIndent !== lastRowIndentL) && lastRowHasText) {\n                    currRegion.p.push(currP);\n                    currP = { start: startTime, end: endTime, spans: [] };\n                    currRegion.y2 = r;\n                    currRegion.name = 'region_' + currRegion.x + '_' + currRegion.y1 + '_' + currRegion.y2;\n                    if (false === seenRegions.hasOwnProperty(currRegion.name)) {\n                        regions.push(currRegion);\n                        seenRegions[currRegion.name] = currRegion;\n                    } else {\n                        existingRegion = seenRegions[currRegion.name];\n                        existingRegion.p.contat(currRegion.p);\n                    }\n\n                    currRegion = { x: rowIndent, y1: r, y2: (r + 1), p: [] };\n                }\n\n                for (let c = 0; c < row.chars.length; ++c) {\n                    let uc = row.chars[c];\n                    let currPenState = uc.penState;\n                    if ((prevPenState === null) || (!currPenState.equals(prevPenState))) {\n                        if (line.trim().length > 0) {\n                            currP.spans.push({ name: currentStyle, line: line, row: r });\n                            line = '';\n                        }\n\n                        let currPenStateString = 'style_cea608_' + currPenState.foreground + '_' + currPenState.background;\n                        if (currPenState.underline) {\n                            currPenStateString += '_underline';\n                        }\n                        if (currPenState.italics) {\n                            currPenStateString += '_italics';\n                        }\n\n                        if (!styleStates.hasOwnProperty(currPenStateString)) {\n                            styleStates[currPenStateString] = JSON.parse(JSON.stringify(currPenState));\n                        }\n\n                        prevPenState = currPenState;\n\n                        currentStyle = currPenStateString;\n                    }\n\n                    line += uc.uchar;\n                }\n\n                if (line.trim().length > 0) {\n                    currP.spans.push({ name: currentStyle, line: line, row: r });\n                }\n\n                lastRowHasText = true;\n                lastRowIndentL = rowIndent;\n            } else {\n                /* Row is empty */\n                lastRowHasText = false;\n                lastRowIndentL = -1;\n\n                if (currRegion) {\n                    currRegion.p.push(currP);\n                    currP = { start: startTime, end: endTime, spans: [] };\n                    currRegion.y2 = r;\n                    currRegion.name = 'region_' + currRegion.x + '_' + currRegion.y1 + '_' + currRegion.y2;\n                    if (false === seenRegions.hasOwnProperty(currRegion.name)) {\n                        regions.push(currRegion);\n                        seenRegions[currRegion.name] = currRegion;\n                    } else {\n                        existingRegion = seenRegions[currRegion.name];\n                        existingRegion.p.contat(currRegion.p);\n                    }\n\n                    currRegion = null;\n                }\n\n            }\n        }\n\n        if (currRegion) {\n            currRegion.p.push(currP);\n            currRegion.y2 = r + 1;\n            currRegion.name = 'region_' + currRegion.x + '_' + currRegion.y1 + '_' + currRegion.y2;\n            if (false === seenRegions.hasOwnProperty(currRegion.name)) {\n                regions.push(currRegion);\n                seenRegions[currRegion.name] = currRegion;\n            } else {\n                existingRegion = seenRegions[currRegion.name];\n                existingRegion.p.contat(currRegion.p);\n            }\n\n            currRegion = null;\n        }\n\n        //log(styleStates);\n        //log(regions);\n\n        let captionsArray = [];\n\n        /* Loop thru regions */\n        for (r = 0; r < regions.length; ++r) {\n            let region = regions[r];\n\n            let cueID = 'sub_cea608_' + (captionId++);\n            let finalDiv = document.createElement('div');\n            finalDiv.id = cueID;\n            let cueRegionProperties = getRegionProperties(region);\n            finalDiv.style.cssText = 'position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;' + cueRegionProperties;\n\n            let bodyDiv = document.createElement('div');\n            bodyDiv.className = 'paragraph bodyStyle';\n            bodyDiv.style.cssText = getStyle(videoElement);\n\n            let cueUniWrapper = document.createElement('div');\n            cueUniWrapper.className = 'cueUniWrapper';\n            cueUniWrapper.style.cssText = 'unicode-bidi: normal; direction: ltr;';\n\n            for (let p = 0; p < region.p.length; ++p) {\n                let ptag = region.p[p];\n                let lastSpanRow = 0;\n                for (s = 0; s < ptag.spans.length; ++s) {\n                    let span = ptag.spans[s];\n                    if (span.line.length > 0) {\n                        if ((s !== 0) && lastSpanRow != span.row) {\n                            let brElement = document.createElement('br');\n                            brElement.className = 'lineBreak';\n                            cueUniWrapper.appendChild(brElement);\n                        }\n                        let sameRow = false;\n                        if (lastSpanRow === span.row) {\n                            sameRow = true;\n                        }\n                        lastSpanRow = span.row;\n                        let spanStyle = styleStates[span.name];\n                        let spanElement = document.createElement('span');\n                        spanElement.className = 'spanPadding ' + span.name + ' customSpanColor';\n                        spanElement.style.cssText = getStyle(videoElement, spanStyle);\n                        if ((s !== 0) && sameRow) {\n                            if (s === ptag.spans.length - 1) {\n                                spanElement.textContent = rtrim(span.line);\n                            } else {\n                                spanElement.textContent = span.line;\n                            }\n                        } else {\n                            if (s === 0) {\n                                if (ptag.spans.length > 1) {\n                                    /* Check if next text is on same row */\n                                    if (span.row === ptag.spans[1].row) {\n                                        /* Next element on same row, trim start */\n                                        spanElement.textContent = ltrim(span.line);\n                                    } else {\n                                        /* Different rows, trim */\n                                        spanElement.textContent = span.line.trim();\n                                    }\n                                } else {\n                                    spanElement.textContent = span.line.trim();\n                                }\n                            } else {\n                                spanElement.textContent = span.line.trim();\n                            }\n                        }\n                        cueUniWrapper.appendChild(spanElement);\n                    }\n                }\n            }\n\n            bodyDiv.appendChild(cueUniWrapper);\n\n            finalDiv.appendChild(bodyDiv);\n\n            let fontSize = { 'bodyStyle': ['%', 90] };\n            for (s in styleStates) {\n                if (styleStates.hasOwnProperty(s)) {\n                    fontSize[s] = ['%', 90];\n                }\n            }\n\n            captionsArray.push({ type: 'html',\n                                start: startTime,\n                                end: endTime,\n                                cueHTMLElement: finalDiv,\n                                cueID: cueID,\n                                cellResolution: [32, 15],\n                                isFromCEA608: true,\n                                regions: regions,\n                                regionID: region.name,\n                                videoHeight: videoElement.videoHeight,\n                                videoWidth: videoElement.videoWidth,\n                                fontSize: fontSize,\n                                lineHeight: {},\n                                linePadding: {}\n                               });\n        }\n        return captionsArray;\n    }\n\n    instance = {\n        createHTMLCaptionsFromScreen: createHTMLCaptionsFromScreen\n    };\n    return instance;\n}\n\nEmbeddedTextHtmlRender.__dashjs_factory_name = 'EmbeddedTextHtmlRender';\nexport default FactoryMaker.getSingletonFactory(EmbeddedTextHtmlRender);\n"]}